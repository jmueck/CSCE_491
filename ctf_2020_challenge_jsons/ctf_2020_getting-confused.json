{
    ".gitignore": "getting-confused\n",
    "build.sh": "#!/bin/bash\n\ndocker build -t gcc:alpine -f Dockerfile.build .\ndocker run --user $(id -u):$(id -g) --rm -ti -v $(pwd):/opt/build gcc:alpine -o getting-confused getting-confused.c\n",
    "Dockerfile": "FROM alpine as build\n\nRUN apk --no-cache add alpine-sdk\n\nADD getting-confused.c /tmp/getting-confused.c\nRUN cd /tmp/; gcc -o getting-confused getting-confused.c\n\nFROM alpine\n\nRUN apk --no-cache add socat\n\nCOPY --from=build /tmp/getting-confused /pwn/getting-confused\nCOPY flag.txt /pwn/flag.txt\n\nWORKDIR /pwn\n\nEXPOSE 4352\n\nENTRYPOINT [\"sh\", \"-c\", \"exec socat -d -d tcp-l:4352,reuseaddr,fork exec:/pwn/getting-confused,pty,setsid,setpgid,stderr,ctty\"]\n",
    "Dockerfile.build": "FROM alpine\n\nRUN apk --no-cache add alpine-sdk\nRUN mkdir -p /opt/build\n\nWORKDIR /opt/build\n\nENTRYPOINT [\"gcc\"]\n",
    "flag.txt": "gigem{fg3ts_g3t5_c0nfu5ed_2}\n",
    "getting-confused.c": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\n#define BUF_SIZE 64\n\nint main() {\n  char temp[BUF_SIZE];\n  char buf[BUF_SIZE];\n  puts(\"Howdy! First floor.\");\n  fgets(buf, sizeof(buf), stdin);\n  strcpy(temp, \"howdy\\n\");\n  if (strcmp(buf, temp)) {\n    puts(\"How 2%er of you.\");\n    exit(1);\n  }\n  puts(\"Thanks and...\");\n  fgets(buf, sizeof(buf), stdin);\n  strcpy(temp, \"gig 'em\\n\");\n  if (strcmp(buf, temp)) {\n    puts(\"How 2%er of you.\");\n    exit(1);\n  }\n  strcpy(temp, \"whoop\\n\");\n  *((void **)buf) = malloc(sizeof(temp));\n  memcpy(*((void **)buf), temp, sizeof(temp));\n  puts(\"What's our secret way of knowing when another one of us is in a crowd?\");\n  fgets(buf, sizeof(buf), stdin);\n  if (strcmp(*((char **)buf), temp)) {\n    puts(\"Begone, 2%er!\");\n    exit(1);\n  }\n  FILE * fd = fopen(\"flag.txt\", \"r\");\n  fgets(buf, sizeof(buf), fd);\n  puts(buf);\n  fclose(fd);\n}\n",
    "README.md": "# Getting Confused\n\n```text\nWe want to test how truly redass you are. In order to do so, we've set up a little test.\n\nConnect to <REPLACE IP>:4352 and answer correctly. We'll even give you the binary the test has for fairness.\n```\n\n## Setup\n\n1. `docker build -t getting-confused .`\n2. `docker run --rm -p 4352:4352 -d getting-confused`\n\n## Brief Dev Description\n\nJust a little binary with a few prompts, socat'd to the world.\n\nUnfortunately, there's stack reuse and fgets doesn't write anything if the file descriptor is closed.\n\n## Solution\n\n```text\n$ socat -,raw,echo=0 tcp:172.17.0.2:4352\nhowdy\ngig 'em\n^D\n```\n\nWhere ^D is EOF in CTTY.\n",
    "category": "Pwn"
}