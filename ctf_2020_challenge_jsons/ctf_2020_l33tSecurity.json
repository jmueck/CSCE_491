{
    "DB_Kill.sh": "#!/bin/bash\nmysql -u root -e \"DROP DATABASE 1337_Secur1ty; DROP USER 'ctfadmin'@'localhost'; DROP USER 'updateadmin'@'localhost'\"\n",
    "Dockerfile": "#Pulling apache/php image.\n#FROM php:7.0-apache\nFROM ubuntu:latest\n\n# Making it so that the CLI will not be interactive during the building of the Docker container.\nARG DEBIAN_FRONTEND=\"noninteractive\"\n\n#Setup command.\n#RUN apt-get -y update && apt-get install -y mysql-server\nRUN apt-get -y update && apt-get install -y apache2 apache2-doc apache2-utils mysql-server php libapache2-mod-php php-mysql\n\n#Copying over the needed web files.\nCOPY /Website/admin_check.php /var/www/html\nCOPY /Website/apply_edit.php /var/www/html\nCOPY /Website/auth.php /var/www/html\nCOPY /Website/cookie_check.php /var/www/html\nCOPY /Website/edit.php /var/www/html\nCOPY /Website/index.php /var/www/html\nCOPY /Website/login.php /var/www/html\nCOPY /Website/logout.php /var/www/html\nCOPY /Website/logo.png /var/www/html\nCOPY /Website/message.php /var/www/html\nCOPY /Website/register_user.php /var/www/html\nCOPY /Website/send.php /var/www/html\nCOPY /Website/sql_connect.php /var/www/html\nCOPY /Website/style.css /var/www/html\nCOPY /Website/.htaccess /var/www/html\n\n#Adding database setup script.\nCOPY Setup.sh /Setup.sh\n\n#Open up port 80 for connections.\nEXPOSE 80\n\n#Running Setup Commands\nRUN service apache2 start\nRUN echo \"<Directory /var/www/html>\" >> /etc/apache2/sites-available/000-default.conf\nRUN echo \"Options Indexes FollowSymLinks\" >> /etc/apache2/sites-available/000-default.conf\nRUN echo \"AllowOverride All\" >> /etc/apache2/sites-available/000-default.conf\nRUN echo \"Require all granted\" >> /etc/apache2/sites-available/000-default.conf\nRUN echo \"</Directory>\" >> /etc/apache2/sites-available/000-default.conf\nRUN a2enmod rewrite\nRUN service apache2 restart\n\nENV APACHE_RUN_USER www-data\nENV APACHE_RUN_GROUP www-data\nENV APACHE_LOG_DIR /var/log/apache2\nENV APACHE_PID_FILE /var/run/apache2.pid\nENV APACHE_RUN_DIR /var/run/apache2\nENV APACHE_LOCK_DIR /var/lock/apache2\n\n#Giving the setup script executable permissions.\nRUN chmod 700 /Setup.sh\nRUN rm /var/www/html/index.html\n\n#Upon start of the container it will launch the setup script.\nENTRYPOINT [\"sh\",\"/Setup.sh\"]\n",
    "README.md": "# Stored TOTP\n\nObjective is for the player to infiltrate the 1337 Secur1ty website and gain access to the admin account, which contains the flag.\nThis will be achieved with a combination of SQL injections, password cracking, and using the Google TOTP implementation. \n\n## Setup\n\nInstall docker and while in the challenge directory, run\n```\nsudo docker build -t totp .\nsudo docker run totp\n```\n\n## Solution\n\nThe vulnerable point is in the GET parameter for the /message page. It is vulnerable to a SQL injection, and tool such as SQLMap can be used against it.\n\nWhen using SQLMap, you will need to provide a valid cookie for the site using '--cookie'. So, you will need to create an account.\n\nUpon dumping the contents of the database, the items of interest are the Secret and Password columns for 1337-admin in the Users table. \n```\nsqlmap -u http://<IP>/message?id=1 --cookie='secret=<secret>; userid=<userid>' -D 1337_Secur1ty -T Users --dump\n```\n\nUsing Google Authenticator for PHP or Python, you can get the current TOTP code by providing the secret to the getCode() function.\n\nI used the Python module when retrieving  the TOTP code.\n```\nimport pyotp\n\ntotp = pyotp.TOTP('<secret>')\nprint totp.now()\n```\n\nWith the password, the password is hashed using MD5 with no salt and the plaintext is from the RockYou wordlist. \n\nI used John the Ripper to crack the password.\n```\njohn --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 CrackMe.txt\n```\n\nUpon retrieving both the TOTP code and the password, you will be able to log into the admin account and you will see the flag on the profile page.\n\ngigem{th3_T0tp_1s_we4k_w1tH_yoU}\n\n## Notes\n\nThe password for ScrubLord is 58BByb9HwvBv2EJsOJ.\n\nThe password for 1337-admin is secretpasscode.\n",
    "Setup.sh": "#!/bin/bash\nservice mysql start;\n\nmysql -u root -e \"CREATE DATABASE 1337_Secur1ty; USE 1337_Secur1ty; CREATE TABLE Users (UserID int(9) NOT NULL auto_increment, Username VARCHAR(20) NOT NULL, Password VARCHAR(50) NOT NULL, FirstName VARCHAR(10) NOT NULL, LastName VARCHAR(15) NOT NULL, Phone VARCHAR(10), Email VARCHAR(37) NOT NULL, Description VARCHAR(200), CreateDate DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP, Secret VARCHAR(50) NOT NULL, PRIMARY KEY(UserID)); CREATE TABLE Messages (MessageID int(9) NOT NULL auto_increment, Username VARCHAR(20) NOT NULL, FirstName VARCHAR(15) NOT NULL, CreateDate DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP, MessageTo VARCHAR(20) NOT NULL, Message VARCHAR(10000), PRIMARY KEY (MessageID)); GRANT SELECT ON 1337_Secur1ty.Users TO 'vulnadmin'@'localhost' IDENTIFIED BY 'ayKOMD13&o8@?!D0FkUB'; GRANT SELECT ON 1337_Secur1ty.Messages TO 'vulnadmin'@'localhost';GRANT SELECT, INSERT ON 1337_Secur1ty.Users TO 'ctfadmin'@'localhost' IDENTIFIED BY 'a7u&09Tq&xLY60lbvPbJ'; GRANT SELECT, INSERT ON 1337_Secur1ty.Messages TO 'ctfadmin'@'localhost'; GRANT SELECT, UPDATE ON 1337_Secur1ty.Users TO 'updateadmin'@'localhost' IDENTIFIED BY 'c%L68TPZ!n!JOxezuKvR'; GRANT SELECT, UPDATE ON 1337_Secur1ty.Messages TO 'updateadmin'@'localhost'; INSERT INTO Users(Username, Password, FirstName, LastName, Phone, Email, Description, Secret) VALUES ('1337-admin', '02ca0b0603222a090fe2fbf3ba97d90c', 'Joe', 'Joeson', '', '1337-admin@l337secur1ty.hak', 'Most secure admin to ever grace existence.', 'WIFHXDZ3BOHJMJSC'); INSERT INTO Users(Username, Password, FirstName, LastName, Phone, Email, Description, Secret) VALUES ('ScrubLord', 'fc8b8be2abe4a79bf6f36eee484c1f08', 'Bob', 'Bobson', '', 'ScrubLord@l337secur1ty.hak', 'That random intern.', '4VCLO52ALSUUO5OM'); INSERT INTO Messages(Username, Firstname, Message, MessageTo) VALUES ('ScrubLord', 'Bob', 'Please don\\'t blow off the meeting today, we need to talk about the cookies.', '1337-admin'); SET PASSWORD FOR 'root'@'localhost' = PASSWORD('JW1gArlX3OqcH1NTE3o');\";\n\napache2 -D FOREGROUND;\n\n#CREATE DATABASE 1337_Secur1ty;\n\n#USE 1337_Secur1ty;\n\n#CREATE TABLE Users (UserID int(9) NOT NULL auto_increment, Username VARCHAR(20) NOT NULL, Password VARCHAR(50) NOT NULL, FirstName VARCHAR(10) NOT NULL, LastName VARCHAR(15) NOT NULL, Phone VARCHAR(10), Email VARCHAR(37) NOT NULL, Description VARCHAR(200), CreateDate DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP, Secret VARCHAR(50) NOT NULL, PRIMARY KEY(UserID));\n#CREATE TABLE Messages (MessageID int(9) NOT NULL auto_increment, Username VARCHAR(20) NOT NULL, FirstName VARCHAR(15) NOT NULL, CreateDate DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP, MessageTo VARCHAR(20) NOT NULL, Message VARCHAR(10000), PRIMARY KEY (MessageID));\n\n#GRANT SELECT ON 1337_Secur1ty.Users TO 'vulnadmin'@'localhost' IDENTIFIED BY 'ayKOMD13&o8@?!D0FkUB';\n#GRANT SELECT ON 1337_Secur1ty.Messages TO 'vulnadmin'@'localhost';\n\n#GRANT SELECT, INSERT ON 1337_Secur1ty.Users TO 'ctfadmin'@'localhost' IDENTIFIED BY 'a7u&09Tq&xLY60lbvPbJ';\n#GRANT SELECT, INSERT ON 1337_Secur1ty.Messages TO 'ctfadmin'@'localhost';\n\n#GRANT SELECT, UPDATE ON 1337_Secur1ty.Users TO 'updateadmin'@'localhost' IDENTIFIED BY 'c%L68TPZ!n!JOxezuKvR';\n#GRANT SELECT, UPDATE ON 1337_Secur1ty.Messages TO 'updateadmin'@'localhost';\n\n#INSERT INTO Users(Username, Password, FirstName, LastName, Phone, Email, Description, Secret) VALUES ('1337-admin', '02ca0b0603222a090fe2fbf3ba97d90c', 'Joe', 'Joeson', '', '1337-admin@l337secur1ty.hak', 'Most secure admin to ever grace existence.', 'WIFHXDZ3BOHJMJSC');\n#INSERT INTO Users(Username, Password, FirstName, LastName, Phone, Email, Description, Secret) VALUES ('ScrubLord', 'fc8b8be2abe4a79bf6f36eee484c1f08', 'Bob', 'Bobson', '', 'ScrubLord@l337secur1ty.hak', 'That random intern.', '4VCLO52ALSUUO5OM');\n\n#INSERT INTO Messages(Username, Firstname, Message, MessageTo) VALUES ('ScrubLord', 'Bob', 'Please don\\'t blow off the meeting today, we need to talk about the cookies.', '1337-admin');\n\n#SET PASSWORD FOR 'root'@'localhost' = PASSWORD('JW1gArlX3OqcH1NTE3o');\n",
    "Website\\.htaccess": "RewriteEngine On\nRewriteCond %{REQUEST_FILENAME}\\.html -f\nRewriteRule ^(.+?)/?$ $1.html [L]\n\nRewriteCond %{REQUEST_FILENAME}\\.php -f\nRewriteRule ^(.+?)/?$ $1.php [L]\n",
    "Website\\admin_check.php": "<?php\n\tinclude 'sql_connect.php';\n\tglobal $conn;\n\n\t$sql = \"SELECT UserID, Secret FROM Users WHERE Username = '1337-admin'\";\n\t$result = mysqli_query($conn, $sql)\n\tor die(\"Error. Ping us so we can fix it.\");\n\n\t$row = mysqli_fetch_assoc($result);\n\t$userid1 = $row['UserID'];\n\t$secret1 = $row['Secret'];\n\n\t$stmt = $conn->prepare(\"SELECT UserID, Secret FROM Users WHERE UserID = ?\");\n\t$stmt->bind_param('s', $_COOKIE['userid']);\n\t$stmt->execute()\n\tor die(\"Error. Ping us so we can fix it.\");\n\t$result = $stmt->get_result()\n\tor die(\"Error. Ping us so we can fix it.\");\n\n\t$row = mysqli_fetch_assoc($result);\n\t$userid2 = $row['UserID'];\n\t$secret2 = $row['Secret'];\n\n\t$stmt = $conn->prepare(\"SELECT UserID, Secret FROM Users WHERE SECRET = ?\");\n\t$stmt->bind_param('s', $_COOKIE['secret']);\n\t$stmt->execute()\n\tor die(\"Error. Ping us so we can fix it.\");\n\t$result = $stmt->get_result()\n\tor die(\"Error. Ping us so we can fix it.\");\n\n\t$row = mysqli_fetch_assoc($result);\n\t$userid3 = $row['UserID'];\n\t$secret3 = $row['Secret'];\n\n\t$adminCheck;\n\tif($userid1 == $userid2 && $userid1 == $userid3 && $userid2 == $userid3 && $secret1 == $secret2 && $secret1 == $secret3 && $secret2 == $secret3 ){\n\t\t$adminCheck = true;\n\t} else {\n\t\t$adminCheck = false;\n\t}\n?>\n",
    "Website\\apply_edit.php": "<?php\n\tinclude 'sql_connect.php';\n\tglobal $updateConn;\n\tinclude 'cookie_check.php';\n\tglobal $cookieCheck;\n\t$nameChange = false;\n\tinclude 'admin_check.php';\n\tglobal $adminCheck;\n\n\tif(!$cookieCheck){\n\t\techo \"ERROR: Need to sign in to a valid account.\";\n\t\theader( \"refresh:5;url=/\" );\n\t} else if ($adminCheck) {\n\t\theader( \"Location: /\" );\n\t} else {\n\t\tif(!empty($_POST['firstname'])){\n\t\t\t$firstname = htmlspecialchars($_POST['firstname'], ENT_QUOTES, 'UTF-8');\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET FirstName = ? WHERE UserID = ?\");\n\t\t\t$stmt->bind_param('ss', $firstname, $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$stmt = $conn->prepare(\"SELECT Username FROM Users WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"s\", $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$result = $stmt->get_result()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$row = mysqli_fetch_assoc($result);\n\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Messages SET FirstName = ? WHERE Username = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $firstname, $row['Username']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$sql = \"UPDATE Messages SET FirstName = '\" . $firstname . \"' WHERE Username = '\" . $row['Username'] . \"'\";\n\t\t\tmysqli_query($conn, $sql);\n\n\t\t\t$nameChange = true;\n\t\t}\n\n\t\tif(!empty($_POST['lastname'])){\n\t\t\t$lastname = htmlspecialchars($_POST['lastname'], ENT_QUOTES, 'UTF-8');\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET LastName = ? WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $lastname, $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$nameChange = true;\n\t\t}\n\n\t\tif(!empty($_POST['phone'])){\n\t\t\t$phone = htmlspecialchars($_POST['phone'], ENT_QUOTES, 'UTF-8');\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET Phone = ? WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $phone, $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t} else {\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET Phone = '' WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"s\", $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t}\n\n\t\tif(!empty($_POST['password'])){\n\t\t\t$pwdHash = md5($_POST['password']);\n\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET Password = ? WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $pwdHash, $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t}\n\n\t\tif(!empty($_POST['description'])){\n\t\t\t$description = htmlspecialchars($_POST['description'], ENT_QUOTES, 'UTF-8');\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET Description = ? WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $description, $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t} else {\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET Description = '' WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"s\", $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t}\n\n\t\tif($nameChange){\n\t\t\t$stmt = $conn->prepare(\"SELECT Username, FirstName, LastName FROM Users WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"s\", $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$result = $stmt->get_result()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\t$originalUsername = $row['Username'];\n\t\t\t$username = strtolower(substr($row['FirstName'], 0, 1)) . strtolower($row['LastName']);\n\t\t\tif($username != $originalUsername){\n\t\t\t\t$checkingUsername = true;\n\t\t\t\t$counter = 0;\n\t\t\t\twhile($checkingUsername){\n\t\t\t\t\t$sql = \"SELECT Username FROM Users\";\n\t\t\t\t\t$result = mysqli_query($conn, $sql);\n\t\t\t\t\t$checkingUsername = false;\n\t\t\t\t\twhile($row = mysqli_fetch_assoc($result)) {\n\t\t\t\t\t\tif($row['Username'] == $username){\n\t\t\t\t\t\t\tif($counter > 0) {\n\t\t\t\t\t\t\t\t$username = substr($username, 0, strlen($username) - strlen((string)$counter));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$username = $username . $counter;\n\t\t\t\t\t\t\t$counter++;\n\t\t\t\t\t\t\t$checkingUsername = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\techo $username;\n\t\t\t\t}\n\t\t\t}\n\t\t\t$email = $username . \"@tamu.edu\";\n\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Users SET Username = ?, Email = ? WHERE UserID = ?\");\n\t\t\t$stmt->bind_param(\"sss\", $username, $email, $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Messages SET Username = ? WHERE Username = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $username, $originalUsername);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$stmt = $updateConn->prepare(\"UPDATE Messages SET MessageTo = ? WHERE MessageTo = ?\");\n\t\t\t$stmt->bind_param(\"ss\", $username, $originalUsername);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t}\n\t\theader('Location: /');\n\t}\n?>\n",
    "Website\\auth.php": "<?php\n\n/**\n * PHP Class for handling Google Authenticator 2-factor authentication.\n *\n * @author Michael Kliewe\n * @copyright 2012 Michael Kliewe\n * @license http://www.opensource.org/licenses/bsd-license.php BSD License\n *\n * @link http://www.phpgangsta.de/\n */\nclass PHPGangsta_GoogleAuthenticator\n{\n    protected $_codeLength = 6;\n\n    /**\n     * Create new secret.\n     * 16 characters, randomly chosen from the allowed base32 characters.\n     *\n     * @param int $secretLength\n     *\n     * @return string\n     */\n    public function createSecret($secretLength = 16)\n    {\n        $validChars = $this->_getBase32LookupTable();\n\n        // Valid secret lengths are 80 to 640 bits\n        if ($secretLength < 16 || $secretLength > 128) {\n            throw new Exception('Bad secret length');\n        }\n        $secret = '';\n        $rnd = false;\n        if (function_exists('random_bytes')) {\n            $rnd = random_bytes($secretLength);\n        } elseif (function_exists('mcrypt_create_iv')) {\n            $rnd = mcrypt_create_iv($secretLength, MCRYPT_DEV_URANDOM);\n        } elseif (function_exists('openssl_random_pseudo_bytes')) {\n            $rnd = openssl_random_pseudo_bytes($secretLength, $cryptoStrong);\n            if (!$cryptoStrong) {\n                $rnd = false;\n            }\n        }\n        if ($rnd !== false) {\n            for ($i = 0; $i < $secretLength; ++$i) {\n                $secret .= $validChars[ord($rnd[$i]) & 31];\n            }\n        } else {\n            throw new Exception('No source of secure random');\n        }\n\n        return $secret;\n    }\n\n    /**\n     * Calculate the code, with given secret and point in time.\n     *\n     * @param string   $secret\n     * @param int|null $timeSlice\n     *\n     * @return string\n     */\n    public function getCode($secret, $timeSlice = null)\n    {\n        if ($timeSlice === null) {\n            $timeSlice = floor(time() / 30);\n        }\n\n        $secretkey = $this->_base32Decode($secret);\n\n        // Pack time into binary string\n        $time = chr(0).chr(0).chr(0).chr(0).pack('N*', $timeSlice);\n        // Hash it with users secret key\n        $hm = hash_hmac('SHA1', $time, $secretkey, true);\n        // Use last nipple of result as index/offset\n        $offset = ord(substr($hm, -1)) & 0x0F;\n        // grab 4 bytes of the result\n        $hashpart = substr($hm, $offset, 4);\n\n        // Unpak binary value\n        $value = unpack('N', $hashpart);\n        $value = $value[1];\n        // Only 32 bits\n        $value = $value & 0x7FFFFFFF;\n\n        $modulo = pow(10, $this->_codeLength);\n\n        return str_pad($value % $modulo, $this->_codeLength, '0', STR_PAD_LEFT);\n    }\n\n    /**\n     * Get QR-Code URL for image, from google charts.\n     *\n     * @param string $name\n     * @param string $secret\n     * @param string $title\n     * @param array  $params\n     *\n     * @return string\n     */\n    public function getQRCodeGoogleUrl($name, $secret, $title = null, $params = array())\n    {\n        $width = !empty($params['width']) && (int) $params['width'] > 0 ? (int) $params['width'] : 200;\n        $height = !empty($params['height']) && (int) $params['height'] > 0 ? (int) $params['height'] : 200;\n        $level = !empty($params['level']) && array_search($params['level'], array('L', 'M', 'Q', 'H')) !== false ? $params['level'] : 'M';\n\n        $urlencoded = urlencode('otpauth://totp/'.$name.'?secret='.$secret.'');\n        if (isset($title)) {\n            $urlencoded .= urlencode('&issuer='.urlencode($title));\n        }\n\n        return 'https://chart.googleapis.com/chart?chs='.$width.'x'.$height.'&chld='.$level.'|0&cht=qr&chl='.$urlencoded.'';\n    }\n\n    /**\n     * Check if the code is correct. This will accept codes starting from $discrepancy*30sec ago to $discrepancy*30sec from now.\n     *\n     * @param string   $secret\n     * @param string   $code\n     * @param int      $discrepancy      This is the allowed time drift in 30 second units (8 means 4 minutes before or after)\n     * @param int|null $currentTimeSlice time slice if we want use other that time()\n     *\n     * @return bool\n     */\n    public function verifyCode($secret, $code, $discrepancy = 1, $currentTimeSlice = null)\n    {\n        if ($currentTimeSlice === null) {\n            $currentTimeSlice = floor(time() / 30);\n        }\n\n        if (strlen($code) != 6) {\n            return false;\n        }\n\n        for ($i = -$discrepancy; $i <= $discrepancy; ++$i) {\n            $calculatedCode = $this->getCode($secret, $currentTimeSlice + $i);\n            if ($this->timingSafeEquals($calculatedCode, $code)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Set the code length, should be >=6.\n     *\n     * @param int $length\n     *\n     * @return PHPGangsta_GoogleAuthenticator\n     */\n    public function setCodeLength($length)\n    {\n        $this->_codeLength = $length;\n\n        return $this;\n    }\n\n    /**\n     * Helper class to decode base32.\n     *\n     * @param $secret\n     *\n     * @return bool|string\n     */\n    protected function _base32Decode($secret)\n    {\n        if (empty($secret)) {\n            return '';\n        }\n\n        $base32chars = $this->_getBase32LookupTable();\n        $base32charsFlipped = array_flip($base32chars);\n\n        $paddingCharCount = substr_count($secret, $base32chars[32]);\n        $allowedValues = array(6, 4, 3, 1, 0);\n        if (!in_array($paddingCharCount, $allowedValues)) {\n            return false;\n        }\n        for ($i = 0; $i < 4; ++$i) {\n            if ($paddingCharCount == $allowedValues[$i] &&\n                substr($secret, -($allowedValues[$i])) != str_repeat($base32chars[32], $allowedValues[$i])) {\n                return false;\n            }\n        }\n        $secret = str_replace('=', '', $secret);\n        $secret = str_split($secret);\n        $binaryString = '';\n        for ($i = 0; $i < count($secret); $i = $i + 8) {\n            $x = '';\n            if (!in_array($secret[$i], $base32chars)) {\n                return false;\n            }\n            for ($j = 0; $j < 8; ++$j) {\n                $x .= str_pad(base_convert(@$base32charsFlipped[@$secret[$i + $j]], 10, 2), 5, '0', STR_PAD_LEFT);\n            }\n            $eightBits = str_split($x, 8);\n            for ($z = 0; $z < count($eightBits); ++$z) {\n                $binaryString .= (($y = chr(base_convert($eightBits[$z], 2, 10))) || ord($y) == 48) ? $y : '';\n            }\n        }\n\n        return $binaryString;\n    }\n\n    /**\n     * Get array with all 32 characters for decoding from/encoding to base32.\n     *\n     * @return array\n     */\n    protected function _getBase32LookupTable()\n    {\n        return array(\n            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', //  7\n            'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', // 15\n            'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', // 23\n            'Y', 'Z', '2', '3', '4', '5', '6', '7', // 31\n            '=',  // padding char\n        );\n    }\n\n    /**\n     * A timing safe equals comparison\n     * more info here: http://blog.ircmaxell.com/2014/11/its-all-about-time.html.\n     *\n     * @param string $safeString The internal (safe) value to be checked\n     * @param string $userString The user submitted (unsafe) value\n     *\n     * @return bool True if the two strings are identical\n     */\n    private function timingSafeEquals($safeString, $userString)\n    {\n        if (function_exists('hash_equals')) {\n            return hash_equals($safeString, $userString);\n        }\n        $safeLen = strlen($safeString);\n        $userLen = strlen($userString);\n\n        if ($userLen != $safeLen) {\n            return false;\n        }\n\n        $result = 0;\n\n        for ($i = 0; $i < $userLen; ++$i) {\n            $result |= (ord($safeString[$i]) ^ ord($userString[$i]));\n        }\n\n        // They are only identical strings if $result is exactly 0...\n        return $result === 0;\n    }\n}\n",
    "Website\\cookie_check.php": "<?php\n\tinclude 'sql_connect.php';\n\tglobal $conn;\n\n\t$stmt = $conn->prepare(\"SELECT UserID, Secret FROM Users WHERE SECRET = ?\");\n\t$stmt->bind_param('s', $_COOKIE['secret']);\n\t$stmt->execute()\n\tor die(\"Error. Ping us so we can fix it.\");\n\t$result = $stmt->get_result()\n\tor die(\"Error. Ping us so we can fix it.\");\n\n\t$row = mysqli_fetch_assoc($result);\n\t$userid1 = $row['UserID'];\n\t$secret1 = $row['Secret'];\n\n\t$stmt = $conn->prepare(\"SELECT UserID, Secret FROM Users WHERE UserID = ?\");\n\t$stmt->bind_param('s', $_COOKIE['userid']);\n\t$stmt->execute()\n\tor die(\"Error. Ping us so we can fix it.\");\n\t$result = $stmt->get_result()\n\tor die(\"Error. Ping us so we can fix it.\");\n\t\n\t$row = mysqli_fetch_assoc($result);\n\t$userid2 = $row['UserID'];\n\t$secret2 = $row['Secret'];\n\n\t$cookieCheck;\n\tif($userid1 == $userid2 && $secret1 == $secret2){\n\t\t$cookieCheck = true;\n\t} else {\n\t\t$cookieCheck = false;\n\t}\n?>\n",
    "Website\\edit.php": "<?php\n\tinclude 'sql_connect.php';\n\tglobal $conn;\n\tinclude 'cookie_check.php';\n\tglobal $cookieCheck;\n\tinclude 'admin_check.php';\n\tglobal $adminCheck;\n\n\tif(!$cookieCheck){\n\t\techo \"ERROR: Need to sign in to a valid account to edit a profile.\";\n\t\theader( \"refresh:5;url=/\" );\n\t} else if ($adminCheck) {\n\t\theader( \"Location: /\" );\n\t} else {\n\t\t$stmt = $conn->prepare(\"SELECT FirstName, LastName, Phone, Description FROM Users WHERE UserID = ?\");\n\t\t$stmt->bind_param(\"s\", $_COOKIE['userid']);\n\t\t$stmt->execute()\n\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t$result = $stmt->get_result()\n\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t$row = mysqli_fetch_assoc($result);\n\t\t$firstname; $lastname; $phone; $description;\n\t\tif(!empty($row['FirstName'])){\n\t\t\t$firstname = $row['FirstName'];\n\t\t} else {\n\t\t\t$firstname = \"\";\n\t\t}\n\t\tif(!empty($row['LastName'])){\n\t\t\t$lastname = $row['LastName'];\n\t\t} else {\n\t\t\t$lastname = \"\";\n\t\t}\n\t\tif(!empty($row['Phone'])){\n\t\t\t$phone = $row['Phone'];\n\t\t} else {\n\t\t\t$phone = \"\";\n\t\t}\n\t\tif(!empty($row['Description'])){\n\t\t\t$description = $row['Description'];\n\t\t} else {\n\t\t\t$description = \"\";\n\t\t}\n?>\n\n<form id='register-user' action='apply_edit' method='POST' accept-charset='UTF-8'>\n\t<fieldset style=\"width:25%\">\n\t\t<legend>Edit Profile</legend>\n\t\t<div style=\"float:left\">\n\t\t\t<label for='firstname'>First Name:</label>\n\t\t\t<br>\n\t\t\t<input type='text' name='firstname' id='firstname' maxlength=\"10\" pattern = \"[a-zA-Z]+\" value=<?php echo \"\\\"$firstname\\\"\";?>/>\n\t\t</div>\n\t\t<div>\n\t\t\t<label for='lastname'>Last Name:</label>\n\t\t\t<br>\n\t\t\t<input type='text' name='lastname' id='lastname' maxlength=\"15\" pattern = \"[a-zA-Z]+\" value=<?php echo \"\\\"$lastname\\\"\";?>/>\n\t\t</div>\n\t\t<div style=\"clear: both;\"></div>\n\t\t<br>\n\n\t\t<div style=\"float:left\">\n\t\t\t<label for='phone'>Phone Number:</label>\n\t\t\t<br>\n\t\t\t<input type=\"tel\" id=\"phone\" name=\"phone\" pattern=\"[0-9]{10}\" oninvalid=\"this.setCustomValidity('Please Enter Correct Phone # - ex. 1234567891')\" oninput=\"this.setCustomValidity('')\" value=<?php echo \"\\\"$phone\\\"\";?>>\n\t\t</div>\n\t\t<div>\n\t\t\t<label for='password'>Password:</label>\n\t\t\t<br>\n\t\t\t<input type='password' name='password' id='password' maxlength=\"50\"/>\n\t\t</div>\n\t\t<div style=\"clear: both;\"></div>\n\t\t<br>\n\n\t\t<label for='description'>Description:</label>\n\t\t<br>\n\t\t<textarea maxlength='10000' name='description' id='description' style='margin-top: 5px; resize: none' rows='4' cols='53'><?php echo $description;?></textarea>\n\t\t<br><br>\n\t\t<input type='Submit' name='Submit' value='Apply' />\n\t\t<pre style=\"display:inline\"> </pre>\n\t</fieldset>\n</form>\n<pre style=\"display:inline\"> </pre>\n<button id='back'>Back</button>\n<script type=\"text/javascript\">\n    \tdocument.getElementById(\"back\").onclick = function () {\n        \tlocation.href = \"/\";\n   \t};\n</script>\n<?php\n\t}\n?>\n",
    "Website\\index.php": "<html>\n<head>\n\t<link rel=\"stylesheet\" href=\"style.css\">\n</head>\n<body>\n\t<?php\n\t\tinclude 'sql_connect.php';\n\t\tinclude 'auth.php';\n\t\tglobal $conn;\n\t\tinclude 'cookie_check.php';\n\t\tglobal $cookieCheck;\n\t\tinclude 'admin_check.php';\n\t\tglobal $adminCheck;\n\t?>\n\t<div class=\"tab\">\n\t\t<?php\n\t\t\tif(!isset($_COOKIE['userid']) || !isset($_COOKIE['secret']) || !$cookieCheck) {\n\t\t?>\n\t\t\t<button class=\"tablinks\" onclick=\"openCity(event, 'Login')\" id=\"defaultOpen\">Login</button>\n  \t\t\t<button class=\"tablinks\" onclick=\"openCity(event, 'Register')\">Register</button>\n\t\t<?php\n\t\t\t}\n\t\t\tif(isset($_COOKIE['userid']) && isset($_COOKIE['secret']) && $cookieCheck) {\n\t\t?>\n\t\t\t<button class=\"tablinks\" onclick=\"openCity(event, 'Profile')\" id=\"defaultOpen\">Profile</button>\n\t\t\t<?php if(!$adminCheck){ ?>\n\t\t\t<button class=\"tablinks\" onclick=\"openCity(event, 'Messages')\">Messages</button>\n\t\t\t<button class=\"tablinks\" onclick=\"openCity(event, 'Employees')\">Employees</button>\n\t\t\t<?php } ?>\n\t\t\t<form id='logout' action='logout.php' method='POST' accept-charset='UTF-8'>\n\t\t\t\t<input type='hidden' name='submitted' id='submitted' value='1' />\n\t\t\t\t<button class=\"tablinks\" style=\"float: right\"type='Submit' name='Submit' />Logout</button>\n\t\t\t</form>\n\t\t<?php\n\t\t\t}\n\t\t?>\n\t</div>\n\t<?php\n\t\tif(!isset($_COOKIE['userid']) || !isset($_COOKIE['secret']) || !$cookieCheck) {\n\t?>\n\t<div id=\"Login\" class=\"tabcontent\">\n\t\t<form id='login' action='login' method='POST' accept-charset='UTF-8'>\n\t\t\t<fieldset style=\"width:25%\">\n\t\t\t\t<legend>Login</legend>\n\n\t\t\t\t<label for='username'> Username:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type='text' name='username' id='username' maxlength=\"20\" required oninvalid=\"this.setCustomValidity('Please Enter Username')\" oninput=\"this.setCustomValidity('')\"/>\n\n\t\t\t\t<br><br>\n\t\t\t\t<label for='password'>Password:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type='password' name='password' id='password' maxlength=\"50\" required oninvalid=\"this.setCustomValidity('Please Enter Password')\" oninput=\"this.setCustomValidity('')\"/>\n\t\t\t\t<br><br>\n\n\t\t\t\t<label for='totp'>TOTP Code:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type='password' name='totp' id='totp' maxlength=\"6\" required oninvalid=\"this.setCustomValidity('Please Enter TOTP Code')\" oninput=\"this.setCustomValidity('')\"/>\n\t\t\t\t<br><br>\n\n\t\t\t\t<input type='Submit' name='Submit' value='Login' />\n\t\t\t</fieldset>\n\t\t</form>\n\t</div>\n\t<div id=\"Register\" class=\"tabcontent\">\n \t\t<form id='register-user' action='register_user' method='POST' accept-charset='UTF-8'>\n\t\t\t<fieldset style=\"width:25%\">\n\t\t\t\t<legend>Register User</legend>\n\n\t\t\t\t<label for='firstname'>First Name:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type='text' name='firstname' id='firstname' maxlength=\"10\" pattern = \"[a-zA-Z]+\" required oninvalid=\"this.setCustomValidity('Please Enter First Name')\" oninput=\"this.setCustomValidity('')\"/>\n\n\t\t\t\t<br><br>\n\t\t\t\t<label for='lastname'>Last Name:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type='text' name='lastname' id='lastname' maxlength=\"15\" pattern = \"[a-zA-Z]+\" required oninvalid=\"this.setCustomValidity('Please Enter Last Name')\" oninput=\"this.setCustomValidity('')\"/>\n\n\t\t\t\t<br><br>\n\t\t\t\t<label for='password'>Password:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type='password' name='password' id='password' maxlength=\"50\" required oninvalid=\"this.setCustomValidity('Please Enter Password')\" oninput=\"this.setCustomValidity('')\"/>\n\n\t\t\t\t<br><br>\n\t\t\t\t<label for='password'>Phone Number:</label>\n\t\t\t\t<br>\n\t\t\t\t<input type=\"tel\" id=\"phone\" name=\"phone\" pattern=\"[0-9]{10}\" oninvalid=\"this.setCustomValidity('Please Enter Correct Phone # - ex. 1234567891')\" oninput=\"this.setCustomValidity('')\">\n\n\t\t\t\t<br><br>\n\t\t\t\t<input type='Submit' name='Submit' value=\"Register\"/>\n\t\t\t</fieldset>\n\t\t\t<b>*** UPON REGISTRATION, ADD QR-CODE TO GOOGLE AUTHENTICATOR APP! ***</b>\n\t\t</form>\n\t</div>\n\t<?php\n\t\t}\n\t\tif(isset($_COOKIE['userid']) && isset($_COOKIE['secret']) && $cookieCheck) {\n\t?>\n\t<div id=\"Profile\" class=\"tabcontent\">\n\t\t<?php\n\t\t\t$stmt = $conn->prepare(\"SELECT * FROM Users WHERE UserID = ?\");\n\t\t\t$stmt->bind_param('s', $_COOKIE['userid']);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$result = $stmt->get_result()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\t$ga = new PHPGangsta_GoogleAuthenticator();\n\n\t\t\t$qrCodeUrl = $ga->getQRCodeGoogleUrl('TAMU_CTF', $_COOKIE['secret']);\n\t\t\techo '<img src=\"'.$qrCodeUrl.'\" align=\"right\"/>';\n\t\t\techo \"<b>Name:</b> \" . $row['FirstName'] . \" \" . $row['LastName'];\n\t\t\techo \"<br style='margin-bottom:10px'>\";\n\t\t\techo \"<b>Username:</b> \" . $row['Username'];\n\t\t\techo \"<br style='margin-bottom:10px'>\";\n\t\t\t$phone = $row['Phone'];\n\t\t\tif(!empty($phone)){\n\t\t\t\t$phone = substr($phone, 0, 3) . \"-\" . substr($phone, 3, 3) . \"-\" . substr($phone, 6, 4);\n\t\t\t} else {\n\t\t\t\t$phone = \"*\";\n\t\t\t}\n\t\t\techo \"<b>Phone:</b> \" . $phone;\n\t\t\techo \"<br style='margin-bottom:10px'>\";\n\t\t\techo \"<b>Email:</b> \" . $row['Email'];\n\t\t\techo \"<br style='margin-bottom:10px'>\";\n\n\t\t\t$dateTime = explode(\" \", $row['CreateDate']);\n\t\t\t$date = $dateTime[0];\n\t\t\t$datePieces = explode(\"-\", $date);\n\t\t\t$date = $datePieces[1] . \"/\" . $datePieces[2] . \"/\" . substr($datePieces[0], 2, 2);\n\t\t\t$datetime = $date . \" \" . substr($dateTime[1], 0, -3);\n\n\t\t\techo \"<b>Account Created On:</b> \" . $datetime;\n\t\t\techo \"<br style='margin-bottom:10px'>\";\n\t\t\techo \"<b>Description:</b> \" . $row['Description'];\n\t\t\tif($adminCheck) {\n\t\t\t\techo \"<br style='margin-bottom:10px'>\";\n\t\t\t\techo \"<b>Flag:</b> gigem{th3_T0tp_1s_we4k_w1tH_yoU}\";\n\t\t\t\techo \"<br><br>\";\n\t\t\t} else {\n\t\t\t\techo \"<br><br>\";\n\t\t\t\techo \"<button id='editProfile'>Edit</button>\";\n\t\t\t}\n\t\t\t?>\n\t\t\t<script type=\"text/javascript\">\n    \t\t\t\tdocument.getElementById(\"editProfile\").onclick = function () {\n        \t\t\t\tlocation.href = \"/edit\";\n   \t \t\t\t};\n\t\t\t</script>\n\t\t\t<br>\n\t</div>\n\t\t\t<?php if(!$adminCheck) { ?>\n\t<div id=\"Messages\" class=\"tabcontent\">\n\t\t<?php\n\t\t\t$id = $_COOKIE['userid'];\n\t\t\t$stmt = $conn->prepare(\"SELECT * FROM Users WHERE UserID = ?\");\n\t\t\t$stmt->bind_param('s', $id);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$result = $stmt->get_result()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\t$globalUsername = $row['Username'];\n\n\t\t\t$sql = \"SELECT * FROM Messages\";\n\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$num_rows = 0;\n\t\t\twhile($row = mysqli_fetch_assoc($result)){\n\t\t\t\tif($row['MessageTo'] == $globalUsername){\n\t\t\t\t\t$num_rows++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t$page_num = (int)($num_rows / 20)+ 1;\n\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\tif(!$adminCheck) {\n\t\t\t\techo \"<button id=\\\"sendMessage\\\">New Message</button>\";\n\t\t\t}\n\t\t?>\n\n\t\t<script type=\"text/javascript\">\n    \t\t\tdocument.getElementById(\"sendMessage\").onclick = function () {\n        \t\t\tlocation.href = \"/send\";\n   \t \t\t};\n\t\t</script>\n\t\t<div style=\"border: 1px solid black; margin:5px;\">\n\t\t\t\t<?php\n\t\t\t\t\t$id = $_COOKIE['userid'];\n\n\t\t\t\t\t$stmt = $conn->prepare(\"SELECT * FROM Users WHERE UserID = ?\");\n\t\t\t\t\t$stmt->bind_param('s', $id);\n\t\t\t\t\t$stmt->execute()\n\t\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t\t\t$result = $stmt->get_result()\n\t\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\t\t\t$globalUsername = $row['Username'];\n\n\t\t\t\t\t$sql = \"SELECT * FROM Messages\";\n\t\t\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t\t\tfor($i = 1; $i <= $page_num; $i++){\n\t\t\t\t\t\techo \"<div id='messagePage$i' class='messageContent'>\";\n\t\t\t\t\t\techo \"<table class='messaging-table'>\";\n  \t\t\t\t\t\techo \"<col width='30'>\";\n  \t\t\t\t\t\techo \"<col width='280'>\";\n\t\t\t\t\t\techo \"<col width='75'>\";\n\t\t\t\t\t\techo \"<col width='60'>\";\n  \t\t\t\t\t\techo \"<tr>\";\n    \t\t\t\t\t\techo \"<th>#</th>\";\n    \t\t\t\t\t\techo \"<th>From</th>\";\n\t\t\t\t\t\techo \"<th>Date</th>\";\n\t\t\t\t\t\techo \"<th>Time</th>\";\n\t\t\t\t\t\techo \"<th>Message</th>\";\n  \t\t\t\t\t\techo \"</tr>\";\n\t\t\t\t\t\tfor($j = 1; $j <= 20; $j++){\n\t\t\t\t\t\t\tif($row = mysqli_fetch_assoc($result)){\n\t\t\t\t\t\t\t\tif($row['MessageTo'] == $globalUsername){\n\t\t\t\t\t\t\t\t\techo \"<tr>\";\n\t\t\t\t\t\t\t\t\t$messageID = $row['MessageID'];\n\t\t\t\t\t\t\t\t\techo \"<td><form class='messageForm' action='message' method='GET'><input type='hidden' name='id' id='id' value='$messageID'><button class='messageLink'>$j</button></form></td>\";\n\t\t\t\t\t\t\t\t\t$firstName = $row['FirstName'];\n\t\t\t\t\t\t\t\t\t$username = $row['Username'];\n    \t\t\t\t\t\t\t\t\techo \"<td>$firstName ($username)</td>\";\n\t\t\t\t\t\t\t\t\t$dateTime = explode(\" \", $row['CreateDate']);\n\t\t\t\t\t\t\t\t\t$date = $dateTime[0];\n\t\t\t\t\t\t\t\t\t$datePieces = explode(\"-\", $date);\n\t\t\t\t\t\t\t\t\t$date = $datePieces[1] . \"/\" . $datePieces[2] . \"/\" . substr($datePieces[0], 2, 2);\n\t\t\t\t\t\t\t\t\techo \"<td>$date</td>\";\n\t\t\t\t\t\t\t\t\t$time = substr($dateTime[1], 0, -3);\n\t\t\t\t\t\t\t\t\techo \"<td>$time</td>\";\n\t\t\t\t\t\t\t\t\t$message = $row['Message'];\n\t\t\t\t\t\t\t\t\tif(strlen($message) > 40) {\n\t\t\t\t\t\t\t\t\t\t$message = substr($row['Message'], 0, 40) . \"...\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\techo \"<td>$message</td>\";\n\t\t\t\t\t\t\t\t\techo \"</tr>\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$j--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"</table>\";\n\t\t\t\t\t\techo \"</div>\";\n\t\t\t\t\t}\n\t\t\t\t?>\n\t\t</div>\n\t\t<div class=\"pagination\">\n\t\t\t<?php\n\n\t\t\t\techo \"<a class='messagePagelink active' onclick=\\\"return openMessagePage(event, 'messagePage1')\\\" href='#' id='defaultMessageOpenPage'>1</a>\";\n\t\t\t\tfor($i = 2; $i <= $page_num; $i++){\n\t\t\t\t\techo \"<a class='messagePagelink' onclick=\\\"return openMessagePage(event, 'messagePage$i')\\\" href='#'>$i</a>\";\n\t\t\t\t}\n\n\t\t\t?>\n\t\t</div>\n\t</div>\n\t<div id=\"Employees\" class=\"tabcontent\">\n\t\t<?php\n\t\t\t$sql = \"SELECT * FROM Users\";\n\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$num_rows = 0;\n\t\t\twhile($row = mysqli_fetch_assoc($result)){\n\t\t\t\t$num_rows++;\n\t\t\t}\n\t\t\t$page_num = (int)($num_rows / 20)+ 1;\n\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t?>\n\t\t<div style=\"border: 1px solid black; margin:5px;\">\n\t\t\t\t<?php\n\t\t\t\t\t$sql = \"SELECT * FROM Users\";\n\t\t\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t\t\tfor($i = 1; $i <= $page_num; $i++){\n\t\t\t\t\t\techo \"<div id='page$i' class='searchContent'>\";\n\t\t\t\t\t\techo \"<table class='messaging-table'>\";\n  \t\t\t\t\t\techo \"<col width='30'>\";\n\t\t\t\t\t\techo \"<col width='175'>\";\n\t\t\t\t\t\techo \"<col width='260'>\";\n\t\t\t\t\t\techo \"<col width='330'>\";\n\t\t\t\t\t\techo \"<col width='130'>\";\n  \t\t\t\t\t\techo \"<tr>\";\n    \t\t\t\t\t\techo \"<th>ID</th>\";\n    \t\t\t\t\t\techo \"<th>Username</th>\";\n\t\t\t\t\t\techo \"<th>Name</th>\";\n\t\t\t\t\t\techo \"<th>Email</th>\";\n\t\t\t\t\t\techo \"<th>Phone</th>\";\n\t\t\t\t\t\techo \"<th>Joined</th>\";\n  \t\t\t\t\t\techo \"</tr>\";\n\t\t\t\t\t\tfor($j = 1; $j <= 20; $j++){\n\t\t\t\t\t\t\tif($row = mysqli_fetch_assoc($result)){\n\t\t\t\t\t\t\t\techo \"<tr>\";\n\t\t\t\t\t\t\t\t$userID = $row['UserID'];\n\t\t\t\t\t\t\t\techo \"<td>$userID</td>\";\n\t\t\t\t\t\t\t\t$username = $row['Username'];\n\t\t\t\t\t\t\t\techo \"<td>$username</td>\";\n\t\t\t\t\t\t\t\t$name = $row['FirstName'] . \" \" . $row['LastName'];\n    \t\t\t\t\t\t\t\techo \"<td>$name</td>\";\n\t\t\t\t\t\t\t\t$email = $row['Email'];\n\t\t\t\t\t\t\t\techo \"<td>$email</td>\";\n\t\t\t\t\t\t\t\t$phone = $row['Phone'];\n\t\t\t\t\t\t\t\tif(!empty($phone)){\n\t\t\t\t\t\t\t\t\t$phone = substr($phone, 0, 3) . \"-\" . substr($phone, 3, 3) . \"-\" . substr($phone, 6, 4);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$phone = \"*\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\techo \"<td>$phone</td>\";\n\t\t\t\t\t\t\t\t$dateTime = explode(\" \", $row['CreateDate']);\n\t\t\t\t\t\t\t\t$date = $dateTime[0];\n\t\t\t\t\t\t\t\t$datePieces = explode(\"-\", $date);\n\t\t\t\t\t\t\t\t$date = $datePieces[1] . \"/\" . $datePieces[2] . \"/\" . substr($datePieces[0], 2, 2);\n\t\t\t\t\t\t\t\t$datetime = $date . \" \" . substr($dateTime[1], 0, -3);\n\t\t\t\t\t\t\t\techo \"<td>$datetime</td>\";\n\t\t\t\t\t\t\t\techo \"</tr>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"</table>\";\n\t\t\t\t\t\techo \"</div>\";\n\t\t\t\t\t}\n\t\t\t\t?>\n\t\t</div>\n\t\t<div class=\"pagination\">\n\t\t\t<?php\n\t\t\t\techo \"<a class='pagelink active' onclick=\\\"return openPage(event, 'page1')\\\" href='#' id='defaultOpenPage'>1</a>\";\n\t\t\t\tfor($i = 2; $i <= $page_num; $i++){\n\t\t\t\t\techo \"<a class='pagelink' onclick=\\\"return openPage(event, 'page$i')\\\" href='#'>$i</a>\";\n\t\t\t\t}\n\t\t\t?>\n\t\t</div>\n\t</div>\n\t\t\t<?php } ?>\n\t<div id=\"Logout\" class=\"tabcontent\">\n\t\t<form id='logout' action='logout.php' method='POST' accept-charset='UTF-8'>\n\t\t\t<input type='hidden' name='submitted' id='submitted' value='1' />\n\t\t\t<br>\n\n\t\t\t<input type='Submit' name='Submit' value='Logout' />\n\t\t</form>\n\t</div>\n\t<?php\n\t\t}\n\t?>\n\t<script>\n\t\tfunction openCity(evt, cityName) {\n \t\t\tvar i, tabcontent, tablinks;\n\t\t\ttabcontent = document.getElementsByClassName(\"tabcontent\");\n  \t\t\tfor (i = 0; i < tabcontent.length; i++) {\n   \t\t\t\ttabcontent[i].style.display = \"none\";\n  \t\t\t}\n  \t\t\ttablinks = document.getElementsByClassName(\"tablinks\");\n  \t\t\tfor (i = 0; i < tablinks.length; i++) {\n   \t\t\t\ttablinks[i].className = tablinks[i].className.replace(\" active\", \"\");\n \t\t\t}\n  \t\t\tdocument.getElementById(cityName).style.display = \"block\";\n  \t\t\tevt.currentTarget.className += \" active\";\n  \t\t\tif(cityName == \"Employees\"){\n   \t\t\t\tdocument.getElementById(\"defaultOpenPage\").click();\n   \t\t\t\twindow.scrollTo(0,0);\n  \t\t\t} else if(cityName == \"Messages\"){\n    \t\t\t\tdocument.getElementById(\"defaultMessageOpenPage\").click();\n    \t\t\t\twindow.scrollTo(0,0);\n  \t\t\t}\n\t\t}\n\t\tfunction openPage(event, page) {\n\t\t\tvar i, searchcontent, pagelinks;\n\t\t\tsearchcontent = document.getElementsByClassName(\"searchcontent\");\n\t\t\tfor (i = 0; i < searchcontent.length; i++) {\n\t\t\t\tsearchcontent[i].style.display = \"none\";\n\t\t\t}\n\t\t\tpagelinks = document.getElementsByClassName(\"pagelink\");\n\t\t\tfor (i = 0; i < pagelinks.length; i++) {\n\t\t\t\tpagelinks[i].className = pagelinks[i].className.replace(\" active\", \"\");\n\t\t\t}\n\t\t\tdocument.getElementById(page).style.display = \"block\";\n\t\t\tevent.currentTarget.className += \" active\";\n\t\t}\n\t\tfunction openMessagePage(event, message) {\n\t\t\tvar i, messageContent, messagePagelinks;\n\t\t\tmessageContent = document.getElementsByClassName(\"messageContent\");\n\t\t\tfor (i = 0; i < messageContent.length; i++) {\n\t\t\t\tmessageContent[i].style.display = \"none\";\n\t\t\t}\n\t\t\tmessagePagelinks = document.getElementsByClassName(\"messagePagelink\");\n\t\t\tfor (i = 0; i < messagePagelinks.length; i++) {\n\t\t\t\tmessagePagelinks[i].className = messagePagelinks[i].className.replace(\" active\", \"\");\n\t\t\t}\n\t\t\tdocument.getElementById(message).style.display = \"block\";\n\t\t\tevent.currentTarget.className += \" active\";\n\t\t}\n\t</script>\n\t<?php\n\t\tif(!isset($_COOKIE['userid']) || !isset($_COOKIE['secret'])) {\n\t?>\n\t<script>\n\t\tdocument.getElementById(\"defaultOpen\").click();\n\t</script>\n\t<?php\n\t\t}\n\t\telse{\n\t?>\n\t<script>\n\t\tdocument.getElementById(\"defaultOpen\").click();\n\t</script>\n\t<?php\n\t\t}\n\t?>\n<br><br>\n<center><img src=\"logo.png\" align=\"middle\" style=\"width:600px;height:150px;\"></center>\n</body>\n</html>\n",
    "Website\\login.php": "<?php\n\tinclude 'sql_connect.php';\n\tinclude 'auth.php';\n\n\tif(isset($_POST['Submit'])) {\n\t\tLogin();\n\t}\n\n\tfunction Login() {\n\t\t$username = $_POST['username'];\n\t\t$password = $_POST['password'];\n\n\t\tif(!CheckLoginDB($username,$password)){\n\t\t\theader('Location: /');\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tfunction CheckLoginDB($username, $password) {\n\t\tglobal $conn;\n\t\t$pwdHash = md5($password);\n\n\t\t$stmt = $conn->prepare(\"SELECT * FROM Users WHERE Username = ? AND Password = ?\");\n\t\t$stmt->bind_param('ss', $username, $pwdHash);\n\t\t$stmt->execute()\n\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t$result = $stmt->get_result()\n\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t$row = mysqli_fetch_assoc($result);\n\n\t\t$ga = new PHPGangsta_GoogleAuthenticator();\n\t\t$checkResult = $ga->verifyCode($row['Secret'], $_POST['totp'], 2);    // 2 = 2*30sec clock tolerance\n\n\t\tif(!empty($row['UserID']) && !empty($row['Secret']) && $checkResult) {\n\t\t\tsetcookie('userid', $row['UserID'], false, '/');\n\t\t\tsetcookie('secret', $row['Secret'], false, '/');\n\t\t\theader('Location: /');\n\t\t}\n\t\telse{\t\n\t\t\treturn false;\n\t\t}\n\t}\n?>\n",
    "Website\\logo.png": "[Binary file or unsupported type: png]",
    "Website\\logout.php": "<?php\n\tsetcookie('userid', '', time() - 3600);\n\tsetcookie('secret', '', time() - 3600);\n\theader(\"Location: /\");\n?>\n",
    "Website\\message.php": "<?php\n\tinclude 'sql_connect.php';\n\tglobal $vulnConn;\n\tinclude 'cookie_check.php';\n\tglobal $cookieCheck;\n\tinclude 'admin_check.php';\n\tglobal $adminCheck;\n\n\tif(!$cookieCheck){\n\t\techo \"ERROR: Need to sign in to a valid account to send a message.\";\n\t\theader( \"refresh:5;url=/\" );\n\t} else if ($adminCheck) {\n\t\theader( \"Location: /\" );\n\t} else {\n\t\tif($_GET['id']){\n\t\t\t$id = $_GET['id'];\n\t\t\t$sql = \"SELECT * FROM Messages WHERE MessageID = '$id'\";\n\t\t\t$result = mysqli_query($vulnConn, $sql)\n\t\t\tor die(\"Brought to you by the 1337est of Secur1ty!!!\");\n\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\techo \"<b>From:</b> \" . $row['FirstName'] . \" (\" . $row['Username'] . \")\";\n\t\t\techo \"<br>\";\n\t\t\t$dateTime = explode(\" \", $row['CreateDate']);\n\t\t\t$date = $dateTime[0];\n\t\t\t$datePieces = explode(\"-\", $date);\n\t\t\t$date = $datePieces[1] . \"/\" . $datePieces[2] . \"/\" . substr($datePieces[0], 2, 2);\n\t\t\t$time = substr($dateTime[1], 0, -3);\n\t\t\techo \"<b>Date:</b> $date\";\n\t\t\techo \"<br>\";\n\t\t\techo \"<b>Time:</b> $time\";\n\t\t\techo \"<br>\";\n\t\t\techo \"<b>Message:</b> <br style='margin-bottom:10px;'>\" ;\n\t\t\techo $row['Message'];\n\t\t\techo \"<br><br>\";\n\t\t\techo \"<button id='back'>Back</button>\";\n\n\t\t\techo \"<script type='text/javascript'>\";\n\t    \t\t\techo \"document.getElementById('back').onclick = function () {\";\n\t\t\t\t\techo \"location.href = '/';\";\n\t   \t \t\techo \"};\";\n\t\t\techo \"</script>\";\n\t\t}\n\t}\n?>\n",
    "Website\\register_user.php": "<?php\n\tinclude 'sql_connect.php';\n\tinclude 'auth.php';\n\n\tif(isset($_POST['Submit'])) {\n\t\tRegister();\n\t}\n\n\tfunction Register() {\n\t\tglobal $conn;\n\t\t$firstname = htmlspecialchars($_POST['firstname'], ENT_QUOTES, 'UTF-8');\n\t\t$lastname = htmlspecialchars($_POST['lastname'], ENT_QUOTES, 'UTF-8');\n\t\t$username = strtolower(substr($firstname, 0, 1)).strtolower($lastname);\n\t\t$checkingUsername = true;\n\t\t$counter = 0;\n\t\t$badUsername = false;\n\t\twhile($checkingUsername){\n\t\t\t$sql = \"SELECT Username FROM Users\";\n\t\t\t$result = mysqli_query($conn, $sql);\n\t\t\t$checkingUsername = false;\n\t\t\twhile($row = mysqli_fetch_assoc($result)) {\n\t\t\t\tif($row['Username'] == $username && $counter == 1000) {\n\t\t\t\t\t$badUsername = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse if($row['Username'] == $username){\n\t\t\t\t\tif($counter > 0) {\n\t\t\t\t\t\t$username = substr($username, 0, strlen($username) - strlen((string)$counter));\n\t\t\t\t\t}\n\t\t\t\t\t$username = $username . $counter;\n\t\t\t\t\t$counter++;\n\t\t\t\t\t$checkingUsername = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif($badUsername) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif($badUsername){\n\t\t\techo \"ERROR: Unfortunately we have run out of available usernames for that first name and last name combination. Please use a first name with a different letter as the first character or use a different last name.\";\n\t\t\theader( \"refresh:10;url=/\" );\n\t\t} else {\n\t\t\t$password = $_POST['password'];\n\t\t\t$pwdHash = md5($password);\n\t\t\t$ga = new PHPGangsta_GoogleAuthenticator();\n\t\t\t$secret = $ga->createSecret();\n\t\t\t$checkingSecret = true;\n\n\t\t\twhile($checkingSecret){\n\t\t\t\t$sql = \"SELECT Secret FROM Users\";\n\t\t\t\t$result = mysqli_query($conn, $sql);\n\t\t\t\t$checkingSecret = false;\n\t\t\t\twhile($row = mysqli_fetch_assoc($result)){\n\t\t\t\t\tif($secret == $row['Secret']){\n\t\t\t\t\t\t$secret = $ga->createSecret();\n\t\t\t\t\t\t$checkingSecret = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$phone;\n\t\t\tif(empty($_POST['phone'])){\n\t\t\t\t$phone = \"\";\n\t\t\t} else {\n\t\t\t\t$phone = htmlspecialchars($_POST['phone'], ENT_QUOTES, 'UTF-8');\n\t\t\t}\n\t\t\t$description = \"\";\n\t\t\t$email = $username . \"@1337secur1ty.hak\";\n\n\t\t\t$stmt = $conn->prepare(\"INSERT INTO Users(Username, Password, FirstName, LastName, Phone, Email, Description, Secret) VALUE (?, ?, ?, ?, ?, ?, ?, ?)\");\n\t\t\t$stmt->bind_param('ssssssss', $username, $pwdHash, $firstname, $lastname, $phone, $email, $description, $secret);\n\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$stmt = $conn->prepare(\"SELECT UserID FROM Users WHERE SECRET = ?\");\n\t\t\t$stmt->bind_param(\"s\", $secret);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t$result = $stmt->get_result()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\tsetcookie('userid', $row['UserID'], false, '/');\n\t\t\tsetcookie('secret', $secret, false, '/');\n\n\t\t\t$stmt = $conn->prepare(\"INSERT INTO Messages(Username, FirstName, MessageTo, Message) VALUE ('1337-admin', 'Joe', ?, 'Welcome to 1337 Secur1ty, the family that you want to work at 16 hours a day. Because here at 1337 Secur1ty, we care!')\");\n\t\t\t$stmt->bind_param('s', $username);\n\t\t\t$stmt->execute()\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\theader('Location: /');\n\t\t\treturn true;\n\t\t}\n\t}\n?>\n",
    "Website\\send.php": "<?php\n\tinclude 'sql_connect.php';\n\tglobal $conn;\n\tinclude 'cookie_check.php';\n\tglobal $cookieCheck;\n\tinclude 'admin_check.php';\n\tglobal $adminCheck;\n\n\tif(!isset($_COOKIE['userid']) || !isset($_COOKIE['secret']) || !$cookieCheck){\n\t\techo \"ERROR: Need to sign in to a valid account to send a message.\";\n\t\theader( \"refresh:5;url=/\" );\n\t} else if ($adminCheck) {\n\t\theader( \"Location: /\" );\n\t} else{\n?>\n\t\t<form id='sendMessage' action='send' method='POST' accept-charset='UTF-8'>\n\t\tTo: <input type='text' name='sendTo' id='sendTo' required oninvalid=\"this.setCustomValidity('Please Enter Username')\" oninput=\"this.setCustomValidity('')\" maxlength='20'>\n\t\t<br>\n\t\t<p style='color:red' name='error' id='error'></p>\n\t\tMessage:<br><textarea maxlength='10000' name='message' id='message' style='margin-top: 5px; resize: none' rows='15' cols='139' required oninvalid=\"this.setCustomValidity('Please Enter Message')\" oninput=\"this.setCustomValidity('')\"></textarea>\n\t\t<input type='Submit' name='Submit' value='Send' />\n\t\t</form>\n<?php\n\t\tif(isset($_POST['Submit'])) {\n\t\t\t$sendTo = htmlspecialchars($_POST['sendTo'], ENT_QUOTES, 'UTF-8');\n\t\t\t$message = htmlspecialchars($_POST['message'], ENT_QUOTES, 'UTF-8');\n\n\t\t\t$sql = \"SELECT Username FROM Users\";\n\t\t\t$result = mysqli_query($conn, $sql)\n\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t$usernameFound = false;\n\t\t\twhile($row = mysqli_fetch_assoc($result)){\n\t\t\tif($row['Username'] == $sendTo){\n\t\t\t\t\t$usernameFound = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!$usernameFound) {\n\t\t\t\techo \"<script>\";\n\t\t\t\techo \"document.getElementById('error').innerHTML = '*That user does not exist!'\";\n\t\t\t\techo \"</script>\";\n\t\t\t} else {\n\t\t\t\t$stmt = $conn->prepare(\"SELECT Username, FirstName FROM Users WHERE Secret = ?\");\n\t\t\t\t$stmt->bind_param('s', $_COOKIE['secret']);\n\t\t\t\t$stmt->execute()\n\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t\t$result = $stmt->get_result()\n\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\n\t\t\t\t$row = mysqli_fetch_assoc($result);\n\t\t\t\t$firstName = $row['FirstName'];\n\t\t\t\t$username = $row['Username'];\n\n\t\t\t\tif($sendTo == $username) {\n\t\t\t\t\techo \"<script>\";\n\t\t\t\t\techo \"document.getElementById('error').innerHTML = '*You can't message yourself!'\";\n\t\t\t\t\techo \"</script>\";\n\t\t\t\t} else {\n\t\t\t\t\t$stmt = $conn->prepare(\"INSERT INTO Messages(Username, FirstName, MessageTo, Message) VALUE (?, ?, ?, ?)\");\n\t\t\t\t\t$stmt->bind_param('ssss', $username, $firstName, $sendTo, $message);\n\t\t\t\t\t$stmt->execute()\n\t\t\t\t\tor die(\"Error. Ping us so we can fix it.\");\n\t\t\t\t\theader('Location: /');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n?>\n",
    "Website\\sql_connect.php": "<?php\n\t$dbHost = 'localhost';\n\t$dbUser = 'ctfadmin';\n\t$dbPass = 'a7u&09Tq&xLY60lbvPbJ';\n\t$db = '1337_Secur1ty';\n\n\t$conn = mysqli_connect($dbHost, $dbUser, $dbPass, $db)\n\tor die(\"Error. Ping us so we can fix it.\");\n\n\t$dbUser = 'updateadmin';\n\t$dbPass = 'c%L68TPZ!n!JOxezuKvR';\n\t$updateConn = mysqli_connect($dbHost, $dbUser, $dbPass, $db)\n\tor die(mysqli_connect_error());\n\n\t$dbUser = 'vulnadmin';\n\t$dbPass = 'ayKOMD13&o8@?!D0FkUB';\n\t$vulnConn = mysqli_connect($dbHost, $dbUser, $dbPass, $db)\n\tor die(mysqli_connect_error());\n?>\n",
    "Website\\style.css": "/* Style the tab */\n.tab {\n  overflow: hidden;\n  border: 1px solid #ccc;\n  background-color: #f1f1f1;\n}\n\n/* Style the buttons that are used to open the tab content */\n.tab button {\n  background-color: inherit;\n  float: left;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  padding: 14px 16px;\n  transition: 0.3s;\n}\n\n/* Change background color of buttons on hover */\n.tab button:hover {\n  background-color: #ddd;\n}\n\n/* Create an active/current tablink class */\n.tab button.active {\n  background-color: #ccc;\n}\n\n/* Style the tab content */\n.tabcontent {\n  display: none;\n  padding: 6px 12px;\n  border: 1px solid #ccc;\n  border-top: none;\n}\n\n.pagination {\n  display: inline-block;\n}\n\n.pagination a {\n  color: blue;\n  float: left;\n  padding: 8px 16px;\n  text-decoration: none;\n  font-size: 10px;\n}\n\n.pagination a.active {\n  background-color: #4CAF50;\n  color: white;\n}\n\n.pagination a:hover:not(.active) {background-color: #ddd;}\n\n.searchcontent {\n  display: none;\n}\n\ntable.messaging-table th {\n\ttext-align: left;\n}\n\ntable.messaging-table td {\n\ttext-align: left;\n\tpadding-bottom: 5px;\n}\n\n.messageLink {\n\tbackground-color: Transparent;\n    \tbackground-repeat:no-repeat;\n    \tborder: none;\n    \tcursor:pointer;\n    \toverflow: hidden;\n    \toutline:none;\n\tcolor: blue;\n}\n\n.messageLink:hover {\n    text-decoration: underline;\n}\n\n.messageForm {\n\tmargin:0;\n\tpadding:0;\n\ttext-align:left;\n\tdisplay: inline;\n}\n",
    "category": "Web"
}