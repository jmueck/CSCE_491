{
    "flag.txt": "gigem{dont_you_just_love_a_good_pcap?}\n",
    "netlogs.pcap": "[Binary file or unsupported type: pcap]",
    "README.md": "# Description\n\nNOTE: This probably shouldn't be called russian nesting doll, but I wanted to check with everyone else first.\nAlso, I'm putting off coming up with a more creative name.\n\nOur monitoring systems noticed some funny-looking DNS traffic on one of our computers.\nWe have the network logs from around the time of the incident.\nWant to take a look?\n\n# Documetation\n\nA pcap-based challenge (ugh, I know) in the spirit of the russian nesting doll.\nI sent an encrypted tarball containing the flag via DNS tunneling.\nThere also some other hoops you have to jump through along the way.\n\n## Setup\n\n1. Deliver netlogs.pcap to the attacker.\n\n# Solution\n\nI think this one is pretty dfficult without being annoying like most pcaps challenges are.\nI left out any red herring traffic, so almost every packet in the pcap is useful.\nThis makes it more of a \"how well do you know wireshark/tshark/how to google things\" rather than a search for a needle in a haystack.\n\nFirst, extract the dns query names from the pcap somehow. I like to use tshark:\n\n```\ntshark -r <input_file> -T fields -e dns.qry.name > output\n```\n\nIf you do it my way, there are a few duplicate lines; remove them:\n\n```\nuniq output > outputnodups\n```\n\nThere's also one packet that says something like `dns._qry._test_qry` that you need to remove.\nNow you have to strip the strings so they don't have the extra hostname junk on them.\nI used awk:\n\n```\nawk -F\"-\" \"{ print $2 }' outputnodups > outfile\n```\n\nThen, base64 decode the file to discover that it's a file encrypted by GPG.\nGood thing there's still some traffic in the pcap.\nThe malicious actor decided to back up both GPG keys to the local unencrypted FTP server.\nDownload the keys from wireshark (they're in FTP-DATA packets) and unencrypt your file.\nYou can get the password by guessing (same PASS as the FTP server), or just use gpg2john.\nFile command shows it's a tarball (there might be another base64 decode in here somewhere).\nExtracting reveals a bunch of files, and they all seem base64 encoded.\nThe one with the flag in it is `........encoded` (I generated all the rest with /dev/urandom).\nDecode once again, and you should get an image of a shark.\nBinwalk the shark and see there are two images in there.\nFor some reason, `binwalk -e` doesn't like to grab just the image on the inside, but `binwalk --dd=\"*\" <file>` did the trick for me.\nThis picture is the flag drawn in MS Paint.\n",
    "category": "Misc"
}