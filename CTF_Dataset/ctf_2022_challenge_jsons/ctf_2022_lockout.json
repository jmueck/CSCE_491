{
    "Dockerfile": "FROM php:7.2-apache\nCOPY src/ /var/www/html/",
    "Makefile": "run:\n\tdocker build -t lockout .\n\tdocker run -d --restart=always --name tamuctf-lockout -p 80:80 lockout\nstop:\n\tdocker container rm -f tamuctf-lockout",
    "README.md": "# Lock Out\n\n## Description\n\nI seem to have locked myself out of my admin panel! Can you find a way back in for me?\n\n## Solution\n\nThe attack target is the login page. I first tried to login with just the normal admin admin credentials and it looked like the entire page simply refreshed. I opened the page in proxy and was able to notice that the login request was a POST request made to `admin.php`. If I tried to simply access `admin.php`, I would get immediately redirected back to `login.php.` However, if I look at the HTTP history, I could render the responses of the POST request to`admin.php` and see that the page before I was redirected away had a button to display the flag. I inspected the HTML and replicated the GET request that the button would do to then again, find the `admin.php` page with the flag displayed in the HTTP history. \n\n`gigem{if_i_cant_wear_croc_martins_to_industry_night_then_im_not_going}`\n",
    "src\\admin.php": "<?php\n    header(\"Location: login.php\");\n\n    if(isset($_GET['PrintFlag'])) {\n\tprintflag();\n    }\n\n    function printflag() {\n\techo \"<p>gigem{if_i_cant_wear_croc_martins_to_industry_night_then_im_not_going}</p>\";\n    }\n?>\n\n<!DOCTYPE html>\n<head>\n    <link rel=\"stylesheet\" href=\"/static/admin.css\">\n</head>\n<body>\n    <h1>Industry Night Shopping List</h1>\n    <p>Croc Martins</p>\n    <img src=\"static/crocmartins.jpg\" alt=\"Croc-Martins\">\n    <form action=\"admin.php\" method=\"get\">\n\t<input type=\"submit\" name=\"PrintFlag\" value=\"PrintFlag\">\n    </form>\n</body>\n",
    "src\\index.php": "<!DOCTYPE html>\n<head>\n    <link rel=\"stylesheet\" href=\"/static/index.css\">\n</head>\n<body>\n    <div class=\"container\">\n     <a href=\"login.php\">\u2728 Login \u2728</a>\n    </div>\n    <div class=\"container\">\n        <div class=\"postcontainer\">\n            <p>i made some grilled cheese today.</p>\n            <p>i burnt one of the sides of bread.</p>\n            <p>Why do I even try \ud83d\ude14</p>\n        </div>\n        <div class=\"postcontainer\">\n            <p>does the sun rotate around the earth</p>\n            <p>or</p>\n            <p>does the earth rotate around the sun</p>\n        </div>\n        <div class=\"postcontainer\">\n            <p>WHAT DO YOU DO IF U SWALLOW TOOTHPASTE</P>\n            <P>ASKING FOR A FRIEND</p>\n        </div>\n        <div class=\"postcontainer\">\n            <p>what is a catboy?</p>         \n            <p>wait do i want to know what a catboy is</p>   \n        </div>\n        <div class=\"postcontainer\">\n            <p>are crocs business casual</p>\n        </div>\n    </div>\n    \n</body>\n",
    "src\\login.php": "<!DOCTYPE html>\n<head>\n    <link rel=\"stylesheet\" href=\"/static/login.css\">\n</head>\n<body>\n<form action=\"admin.php\" method=\"post\">\n    <div class=\"container\">\n        <label for=\"uname\"><b>Username</b></label>\n        <input type=\"text\" placeholder=\"Enter Username\" name=\"username\" required>\n\n        <label for=\"psw\"><b>Password</b></label><br>\n        <input type=\"password\" placeholder=\"Enter Password\" name=\"password\" required>\n\n        <button type=\"submit\">Login</button>\n    </div>\n</form>\n</body>\n",
    "src\\static\\admin.css": "body {\n    background-color: #B6CBE2;\n}",
    "src\\static\\crocmartins.jpg": "[Binary file or unsupported type: jpg]",
    "src\\static\\index.css": "body {\n    background-color: #B6CBE2;\n    margin: 0;\n   \n    font-family: 'Noto Sans', sans-serif;\n    font-size: 100%; \n}\n\n  \na, a:visited {\n    text-decoration: none;\n    text-align: right;\n    display: block;\n    color: black;\n\n}\n\n.container {\n    max-width: 40em;  \n    margin-left: auto;\n    margin-right: auto;   \n\n    padding-top: 1rem;\n\n}\n\n.postcontainer {\n    background-color: white;\n    padding-left: 3rem;\n    padding-right: 3rem;\n    padding-top: 1rem;\n    padding-bottom: 1rem;\n    margin-top: 1rem;\n    margin-bottom: 1rem;\n}\n\np {\n    color: rgb(27, 27, 27);\n}",
    "src\\static\\login.css": "body {\n    background-color: #B6CBE2;\n}\n\n.container {\n    max-width: 15em;  \n    max-height: 30em;\n\n    margin-left: auto;\n    margin-right: auto;\n\n    padding: 3rem;\n\n    font-family: 'Noto Sans', sans-serif;\n    font-size: 150%;\n}\n\ninput {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 1em 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    box-sizing: border-box;\n}\n\nbutton {\n    color: white;\n    background-color: #054A91;\n\n    padding: 14px 20px;\n    margin: 1em 0;\n    border: none;\n    width: 100%;\n\n    margin-left: auto;\n    margin-right: auto;\n\n    cursor: pointer;\n}\n\nbutton:hover {\n    color: black;\n    background-color: white;\n}",
    "category": "web"
}